
<!-- saved from url=(0110)https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/reflection-refraction-fresnel -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- title should be set at this point in page.php -->
<title>Introduction to Shading (Reflection, Refraction and Fresnel)</title>

<meta name="author" content="Scratchapixel">
<meta name="copyright" content="© 2009-2016 Scratchapixel">
<meta name="keywords" content="shading, light, shadow, diffuse, mirror, reflection, refraction, transmission, index of refraction, Snell" s="" law,="" reflection="" fresnel="" equation,="" inverse-square="" square="" falloff,="" distant="" light,="" spherical="" point="" sun,="" shadow,="" shadow="" acne,="" map,="" lambert="" cosine="" albedo,="" texturing,="" procedural="" aliasing,="" anti-aliasing,="" texture="" coordinates,="" checkerboard="" pattern,="" specular="" reflection,="" glossy="" roughness,="" dielectric,="" conductor,="" delta="" area="" ray,="" bias,="" differential="" area,="" diffuse="" brdf,="" normal,="" facing="" ratio,="" smooth="" shading,="" gouraud="" physically="" based="" rendering,="" photorealistic="" direct="" illumination,="" indirect="" view="" dependent,="" independent'="">
<meta name="date" content="2014-08-15 10:34:46">

<link rel="stylesheet" type="text/css" href="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/scratchapixel.css">
<link rel="stylesheet" type="text/css" href="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/page.css">

<link href="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/css" rel="stylesheet" type="text/css">
<link href="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/css(1)" rel="stylesheet" type="text/css">

<!-- using the material icons from Google http://google.github.io/material-design-icons/ -->
<link rel="stylesheet" href="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/icon">

<script id="twitter-wjs" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/widgets.js"></script><script id="facebook-jssdk" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/sdk.js"></script><script async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/x-mathjax-config;executed=true">
MathJax.Hub.Config(
	{tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}, 
	displayAlign: "left",
	displayIndent: "1em",
	"HTML-CSS": { scale: 90 },
	jax: ["input/TeX","input/MathML","input/AsciiMath","output/HTML-CSS","output/NativeMML"],
	extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js"],
	TeX: {
		extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
	}}
);
</script>

<script type="text/javascript" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/MathJax.js"></script>

<script type="text/javascript" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/scratchapixelSDK.js">
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42771397-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- 
https://developers.facebook.com/docs/plugins/share-button/
Include the JavaScript SDK on your page once, ideally right after the opening <body> tag.
-->

<script>
  window.fbAsyncInit = function() {
	FB.init({
	  appId      : '1535346446701691',
	  xfbml      : true,
	  version    : 'v2.1'
	});
  };

  (function(d, s, id){
	 var js, fjs = d.getElementsByTagName(s)[0];
	 if (d.getElementById(id)) {return;}
	 js = d.createElement(s); js.id = id;
	 js.src = "//connect.facebook.net/en_US/sdk.js";
	 fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>

<script>
	!function(d,s,id) {
		var js,fjs=d.getElementsByTagName(s)[0];
		if(!d.getElementById(id)) {
			js=d.createElement(s);js.id=id;
			js.src="https://platform.twitter.com/widgets.js";
			fjs.parentNode.insertBefore(js,fjs);
		}
	}(document,"script","twitter-wjs");
</script>


<style>
.full-page1
{
	position: relative;
	margin: 0; padding: 0; 
	width: 100%; 
	border: 1px solid red;
	color: white;
}

.full-page-header-table1
{
	display: table; 
	width: 100%;
	border: 1px solid orange;
}
</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style></head>



<body onload="onload();"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><div style="display: table; width: 100%;">
	<!-- 
		This should be the content of the top menu bar. So if you want to reuse
		this, just create a table div above and insert the section.
		The height here doesn't mater because it's controlled by the inner table.
-->
<div style="display: table-row;  height: 40px; width: 100%; background-color: #1565C0; color: white;">
	<!-- we center the cell in the middle of the row -->
	<div style="display: table-cell; width: 100%; border: 1px none orange; vertical-align: middle; text-align: center;">
		
		<div style="display: inline-block; position: relative; border: 1px none black; width: 670px; margin: 0 auto; padding: 0;">			
			<!-- 
				This is our logo 
			-->
			<div style="display: inline-block; border: 2px none green;">
				<span style="font-size: 18px; font-weight: 800;"><a href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/index.php" style="text-decoration: none; color: white;">Scratchapixel 2.0</a></span>
			</div>
			<!-- 
				This is login 
				The only way you can vertically center stuff here is by forcing the height of the div
				and the eight of the text to be the same
			-->
			<div style="border: 2px none green; position: absolute; right: 0;  top: 0; bottom: 0px; height: 20px; line-height: 20px; margin: auto 0;">
				<a style="color: white; text-decoration: none;" href="https://www.facebook.com/v2.5/dialog/oauth?client_id=1682406642074489&amp;state=2e793d98809b955ea2037193d5e5eaff&amp;response_type=code&amp;sdk=php-sdk-5.4.0&amp;redirect_uri=https%3A%2F%2Fwww.scratchapixel.com%2Ffb-callback.php%3F&amp;scope=email">Sign in</a>			</div>
			
		</div>
	</div>
</div></div>



<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/iPrOY23SGAp.html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div> <!-- that's required by FB -->
<div class="page-content">
<article><div id="sap-root"></div><!-- that's needed by scratchapixel see onload() --><div class="lesson-title">Introduction to Shading</div><div class="chapter-table"><div class="chapter-row"><div class="chapter-cell"><b>Contents</b></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/what-is-shading-light-matter-interaction">What is Shading: Light-Matter interaction</a></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/shading-normals">Normals, Vertex Normals and Facing Ratio</a></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/shading-lights">Lights</a></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/diffuse-lambertian-shading">Diffuse and Lambertian Shading</a></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/ligth-and-shadows">Light and Shadows</a></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/shading-spherical-light">Spherical Light</a></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/shading-multiple-lights">Multiple Lights</a></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/reflection-refraction-fresnel"><b>Reflection, Refraction and Fresnel</b></a></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/procedural-texturing">Procedural Texturing</a></div></div><div class="chapter-row"><div class="chapter-cell"><a style="text-decoration: none;" href="https://www.scratchapixel.com/code.php?id=13&amp;origin=/lessons/3d-basic-rendering/introduction-to-shading">Source Code</a></div></div></div><p>Your are subscriber and logged in!</p><h2>Reflection, Refraction (Transmission) and Fresnel</h2>

<p>Reflection and refraction are very common in the real world and can be observed every day. Glass or water are two very common materials which exhibit both properties. Light can pass through them, a phenomenon we call <b>transmission</b> and they can reflect light at the same time. The important question we will need to answer in this chapter is how do we know how much light is transmitted versus how much light is reflected? To answer this question, we will need to learn about the <b>Fresnel</b> effect. Other materials are opaque and can not transmit any light though they can certainly reflect it very well. This is the case for example of metals.</p>

<p>In this chapter, we will learn about simulating reflection, refraction (transmission) and the Fresnel effect which defines for transparent materials such as glass and water how much light is reflected vs. how much light is transmitted.</p> 

<img class="left" style="margin-bottom: 12px;" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-fresnel2.png">

<div><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=78FWLXMM9YGPN" '=""><img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/donate.png"></a></div><h2>Reflection</h2>

<div style="width: 400;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-reflection.png"><p class="caption left">Figure 1:  the angle of incidence and the angle of reflection are equal.</p>
</div>

<div style="width: 400;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-reflection2.png"><p class="caption left">Figure 2:  computing the reflection direction can be done using simple geometry.</p>
</div>

<p>Let's start with reflection which is almost the simplest form of light-matter interaction. Reflection is the result of what happens to a photon, or an incident light beam if you are not familiar with the concept of photon, when it hits the surface of a reflective surface such as glass, water, or a sheet of aluminium for example. What happens to this photon, is very similar to what happens to a tennis ball when it hits the surface of the floor. It bounces back in a direction which is symmetrical to the incident direction about the surface normal at the point of impact as shown in figure 1. In other words, if the angle between the incident direction and the surface normal is denoted <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.172em 1000.74em 1.354em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-1">\theta_i</script> and the angle between the reflected direction and the surface normal is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 0.96em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.172em 1000.85em 1.354em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-9" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mi" id="MathJax-Span-10" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">\theta_r</script>, then <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-11" style="width: 3.269em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.931em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.93em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-12"><span class="msubsup" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-14" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mi" id="MathJax-Span-15" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-16" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="msubsup" id="MathJax-Span-17" style="padding-left: 0.341em;"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-18" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>θ</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">\theta_i = \theta_r</script>. Simple! This is called the <b>law of reflection</b>.</p>

<p>Computing the reflection direction when the incident direction and the surface normal are known is very simple. As you can see in figure 2, the vectors I and R can be expressed in terms of the vector A and B:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-20" style="width: 7.21em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 6.478em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.735em 1006.25em 3.494em -999.997em); top: -2.362em; left: 0em;"><span class="mrow" id="MathJax-Span-21"><span class="mtable" id="MathJax-Span-22" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 6.14em; height: 0px;"><span style="position: absolute; clip: rect(2.48em 1000.57em 4.958em -999.997em); top: -3.995em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.4em 4.169em -999.997em); top: -4.671em; left: 0em;"><span class="mtd" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1000.57em 4.169em -999.997em); top: -3.207em; left: 0em;"><span class="mtd" id="MathJax-Span-35"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37" style="font-family: STIXGeneral; font-style: italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.762em 1000.62em 4.901em -999.997em); top: -3.995em; left: 1.748em;"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px;"><span style="position: absolute; clip: rect(3.437em 1000.62em 4.169em -999.997em); top: -4.671em; left: 0em;"><span class="mtd" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="mo" id="MathJax-Span-28" style="font-family: STIXGeneral;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.437em 1000.62em 4.169em -999.997em); top: -3.207em; left: 0em;"><span class="mtd" id="MathJax-Span-38"><span class="mrow" id="MathJax-Span-39"><span class="mo" id="MathJax-Span-40" style="font-family: STIXGeneral;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.48em 1002.54em 5.07em -999.997em); top: -3.995em; left: 3.55em;"><span style="display: inline-block; position: relative; width: 2.593em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1002.54em 4.338em -999.997em); top: -4.671em; left: 0em;"><span class="mtd" id="MathJax-Span-29"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mo" id="MathJax-Span-32" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-33" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">B</span><span class="mo" id="MathJax-Span-34" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1002.54em 4.338em -999.997em); top: -3.207em; left: 0em;"><span class="mtd" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mo" id="MathJax-Span-44" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-45" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">B</span><span class="mo" id="MathJax-Span-46" style="font-family: STIXGeneral;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>I</mi></mtd><mtd><mo>=</mo></mtd><mtd><mi>A</mi><mo>+</mo><mi>B</mi><mo>,</mo></mtd></mtr><mtr><mtd><mi>R</mi></mtd><mtd><mo>=</mo></mtd><mtd><mi>A</mi><mo>−</mo><mi>B</mi><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">
\begin{array}{l}
I &=& A + B,\\
R &=& A - B.
\end{array}
</script>

<p>The vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-47" style="width: 0.678em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.62em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-48"><span class="mi" id="MathJax-Span-49" style="font-family: STIXGeneral; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">B</script> can easily be computed. It is the projection of the vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.397em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.4em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">I</script> or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 0.678em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.62em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: STIXGeneral; font-style: italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">R</script> onto the vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-56" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.74em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="mi" id="MathJax-Span-58" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">N</script>. As explained in the lesson on geometry (check the <a href="http://www.scratchapixel.com/lessons/mathematics-physics-for-computer-graphics/geometry/math-operations-on-points-and-vectors">dot product</a> paragraph), this can be computed using the following equation:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-59" style="width: 7.154em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 6.422em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1006.37em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-family: STIXGeneral; font-style: italic;">B</span><span class="mo" id="MathJax-Span-62" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-63" style="font-family: STIXGeneral; padding-left: 0.341em;">cos</span><span class="mo" id="MathJax-Span-64"></span><span class="mo" id="MathJax-Span-65" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-66" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-67" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-68" style="font-family: STIXGeneral; padding-left: 0.228em;">∗</span><span class="mi" id="MathJax-Span-69" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-70" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>B</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>N</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">B = \cos(\theta) * N.</script>

<p>The term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" style="width: 2.762em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.48em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.42em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: STIXGeneral;">cos</span><span class="mo" id="MathJax-Span-74"></span><span class="mo" id="MathJax-Span-75" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-76" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-77" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">\cos(\theta)</script> is of course equal to: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-78" style="width: 1.692em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.523em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1001.52em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-81" style="font-family: STIXGeneral;">.</span><span class="mi" id="MathJax-Span-82" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.172em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>.</mo><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">N.I</script>. It is the dot product between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-83" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.74em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">N</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-86" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.397em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.4em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">I</script>.</p>

<p>We can now replace <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-89" style="width: 0.678em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.62em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-family: STIXGeneral; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">B</script> in both equations:</p>

 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-92" style="width: 11.208em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 10.082em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.735em 1009.86em 3.494em -999.997em); top: -2.362em; left: 0em;"><span class="mrow" id="MathJax-Span-93"><span class="mtable" id="MathJax-Span-94" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 9.744em; height: 0px;"><span style="position: absolute; clip: rect(2.48em 1000.57em 4.958em -999.997em); top: -3.995em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.4em 4.169em -999.997em); top: -4.671em; left: 0em;"><span class="mtd" id="MathJax-Span-95"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1000.57em 4.169em -999.997em); top: -3.207em; left: 0em;"><span class="mtd" id="MathJax-Span-113"><span class="mrow" id="MathJax-Span-114"><span class="mi" id="MathJax-Span-115" style="font-family: STIXGeneral; font-style: italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.762em 1000.62em 4.901em -999.997em); top: -3.995em; left: 1.748em;"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px;"><span style="position: absolute; clip: rect(3.437em 1000.62em 4.169em -999.997em); top: -4.671em; left: 0em;"><span class="mtd" id="MathJax-Span-98"><span class="mrow" id="MathJax-Span-99"><span class="mo" id="MathJax-Span-100" style="font-family: STIXGeneral;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.437em 1000.62em 4.169em -999.997em); top: -3.207em; left: 0em;"><span class="mtd" id="MathJax-Span-116"><span class="mrow" id="MathJax-Span-117"><span class="mo" id="MathJax-Span-118" style="font-family: STIXGeneral;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.48em 1006.14em 5.127em -999.997em); top: -3.995em; left: 3.55em;"><span style="display: inline-block; position: relative; width: 6.197em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1006.14em 4.338em -999.997em); top: -4.671em; left: 0em;"><span class="mtd" id="MathJax-Span-101"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mo" id="MathJax-Span-104" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-105" style="font-family: STIXGeneral; padding-left: 0.228em;">cos</span><span class="mo" id="MathJax-Span-106"></span><span class="mo" id="MathJax-Span-107" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-108" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-109" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-110" style="font-family: STIXGeneral; padding-left: 0.228em;">∗</span><span class="mi" id="MathJax-Span-111" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-112" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1006.14em 4.338em -999.997em); top: -3.207em; left: 0em;"><span class="mtd" id="MathJax-Span-119"><span class="mrow" id="MathJax-Span-120"><span class="mi" id="MathJax-Span-121" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mo" id="MathJax-Span-122" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-123" style="font-family: STIXGeneral; padding-left: 0.228em;">cos</span><span class="mo" id="MathJax-Span-124"></span><span class="mo" id="MathJax-Span-125" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-126" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-127" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-128" style="font-family: STIXGeneral; padding-left: 0.228em;">∗</span><span class="mi" id="MathJax-Span-129" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-130" style="font-family: STIXGeneral;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>I</mi></mtd><mtd><mo>=</mo></mtd><mtd><mi>A</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>N</mi><mo>,</mo></mtd></mtr><mtr><mtd><mi>R</mi></mtd><mtd><mo>=</mo></mtd><mtd><mi>A</mi><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>N</mi><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">
\begin{array}{l}
I &=& A + \cos(\theta) * N,\\
R &=& A - \cos(\theta) * N.
\end{array}
</script>

<p>We can re-write the first equation as follows:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-131" style="width: 8.843em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 7.942em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1007.89em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mo" id="MathJax-Span-134" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-135" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.341em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-136" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-137" style="font-family: STIXGeneral; padding-left: 0.228em;">cos</span><span class="mo" id="MathJax-Span-138"></span><span class="mo" id="MathJax-Span-139" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-140" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-141" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-142" style="font-family: STIXGeneral; padding-left: 0.228em;">∗</span><span class="mi" id="MathJax-Span-143" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-144" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mo>=</mo><mi>I</mi><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>N</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">A = I - \cos(\theta) * N.</script>

<p>We can write the second equation using this result as follows:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-145" style="width: 16.895em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 15.206em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.003em 1014.98em 4.226em -999.997em); top: -2.362em; left: 0em;"><span class="mrow" id="MathJax-Span-146"><span class="mtable" id="MathJax-Span-147" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 14.868em; height: 0px;"><span style="position: absolute; clip: rect(2.368em 1000.57em 6.253em -999.997em); top: -4.558em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.57em 4.169em -999.997em); top: -5.403em; left: 0em;"><span class="mtd" id="MathJax-Span-148"><span class="mrow" id="MathJax-Span-149"><span class="mi" id="MathJax-Span-150" style="font-family: STIXGeneral; font-style: italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1000.57em 4.169em -999.997em); top: -3.939em; left: 0em;"><span class="mtd" id="MathJax-Span-174"><span class="mrow" id="MathJax-Span-175"><span class="mi" id="MathJax-Span-176" style="font-family: STIXGeneral; font-style: italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1000.57em 4.169em -999.997em); top: -2.475em; left: 0em;"><span class="mtd" id="MathJax-Span-192"><span class="mrow" id="MathJax-Span-193"><span class="mi" id="MathJax-Span-194" style="font-family: STIXGeneral; font-style: italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.564em;"></span></span><span style="position: absolute; clip: rect(2.311em 1000.62em 5.915em -999.997em); top: -4.276em; left: 1.748em;"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px;"><span style="position: absolute; clip: rect(3.437em 1000.62em 4.169em -999.997em); top: -5.403em; left: 0em;"><span class="mtd" id="MathJax-Span-151"><span class="mrow" id="MathJax-Span-152"><span class="mo" id="MathJax-Span-153" style="font-family: STIXGeneral;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.437em 1000.62em 4.169em -999.997em); top: -3.939em; left: 0em;"><span class="mtd" id="MathJax-Span-177"><span class="mrow" id="MathJax-Span-178"><span class="mo" id="MathJax-Span-179" style="font-family: STIXGeneral;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.437em 1000.62em 4.169em -999.997em); top: -2.475em; left: 0em;"><span class="mtd" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mo" id="MathJax-Span-197" style="font-family: STIXGeneral;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.282em;"></span></span><span style="position: absolute; clip: rect(2.48em 1011.26em 6.591em -999.997em); top: -4.727em; left: 3.55em;"><span style="display: inline-block; position: relative; width: 11.32em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1011.26em 4.338em -999.997em); top: -5.403em; left: 0em;"><span class="mtd" id="MathJax-Span-154"><span class="mrow" id="MathJax-Span-155"><span class="mi" id="MathJax-Span-156" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-157" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-158" style="font-family: STIXGeneral; padding-left: 0.228em;">cos</span><span class="mo" id="MathJax-Span-159"></span><span class="mo" id="MathJax-Span-160" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-161" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-162" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-163" style="font-family: STIXGeneral; padding-left: 0.228em;">∗</span><span class="mi" id="MathJax-Span-164" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-165" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-166" style="font-family: STIXGeneral; padding-left: 0.228em;">cos</span><span class="mo" id="MathJax-Span-167"></span><span class="mo" id="MathJax-Span-168" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-169" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-170" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-171" style="font-family: STIXGeneral; padding-left: 0.228em;">∗</span><span class="mi" id="MathJax-Span-172" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-173" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1005.63em 4.338em -999.997em); top: -3.939em; left: 0em;"><span class="mtd" id="MathJax-Span-180"><span class="mrow" id="MathJax-Span-181"><span class="mi" id="MathJax-Span-182" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-183" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mn" id="MathJax-Span-184" style="font-family: STIXGeneral; padding-left: 0.228em;">2</span><span class="mi" id="MathJax-Span-185" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-186"></span><span class="mo" id="MathJax-Span-187" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-188" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-189" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-190" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-191" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1005.47em 4.338em -999.997em); top: -2.475em; left: 0em;"><span class="mtd" id="MathJax-Span-198"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-201" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mn" id="MathJax-Span-202" style="font-family: STIXGeneral; padding-left: 0.228em;">2</span><span class="mo" id="MathJax-Span-203" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-204" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-205" style="font-family: STIXGeneral; padding-left: 0.228em;">⋅</span><span class="mi" id="MathJax-Span-206" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-207" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-208" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-209" style="font-family: STIXGeneral;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.733em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.934em; border-left: 0px solid; width: 0px; height: 4.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>R</mi></mtd><mtd><mo>=</mo></mtd><mtd><mi>I</mi><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>N</mi><mo>−</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>N</mi><mo>,</mo></mtd></mtr><mtr><mtd><mi>R</mi></mtd><mtd><mo>=</mo></mtd><mtd><mi>I</mi><mo>−</mo><mn>2</mn><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>N</mi><mo>,</mo></mtd></mtr><mtr><mtd><mi>R</mi></mtd><mtd><mo>=</mo></mtd><mtd><mi>I</mi><mo>−</mo><mn>2</mn><mo stretchy="false">(</mo><mi>N</mi><mo>⋅</mo><mi>I</mi><mo stretchy="false">)</mo><mi>N</mi><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">
\begin{array}{l}
R &=& I - \cos(\theta) * N - \cos(\theta) * N,\\
R &=& I - 2\cos(\theta) N,\\
R &=& I - 2(N \cdot I)N.
\end{array}
</script>

<div style="width: 400;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-reflection3.png"><p class="caption left">Figure 3:  the eye only "sees" the image of the object whose reflection direction coincidences with the view direction.</p>
</div>

<p>A reflection of a light ray can only be seen if the reflected ray direction is traveling in the same direction that then view direction. In figure 3, you can see the reflection of three rays with distinct incident directions and distinct colors. While the light beams intersects the surface in the same exact point on the surface, the observer will only see the reflection of the ray in the middle (the ray with the orange color). If you fix the view direction and change the direction of the incident ray in the middle even just slightly, then the observer will stop seeing the reflection of that ray. To see the reflection of the ray again, the observer would need to change his/her position to align his/her view direction with the direction of the orange reflected ray. If the direction of the incident is fixed but that the observer moves, then if the view direction is aligned with the reflection direction of the red, orange and green reflected ray successively, then the viewer would see in turn a red, orange and then green point on the surface of the object. This is very similar to what happens when we observe the reflection of the sun by a wavy water surface. We can see the reflection of the sun when the angle of the wave with respect to the viewer is right but because the shape of the wave changes rapidly the reflection can appear as well as disappear quickly (glittering effect).</p>

<img class="left" style="margin-bottom: 12px;" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-glitter.png">

<p>The fact that the reflected image of the objects in the scene from which these light rays are emitted changes with the view direction, is the reason why we say that reflection is <b>view dependent</b>. If you look at the reflection of a static object in the mirror and change direction, you will see that the image of that object changes. This is something that we find natural when we look at object from a different angle, but that we find maybe less natural when we change our position with respect to a mirror reflecting that same object, though the reason why this is happening is essentially the same. We look at a different part of the object. By opposition we say that diffuse reflections are <b>view independent</b> because they don't vary with the angle of view as explained in the chapter on <a href="http://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/diffuse-lambertian-shading">Lambertian material</a>. </p>

<div style="width: 400;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-reflection5.png"><p class="caption left">Figure 4:  if the surface that the primary ray intersects is a mirror we then cast a ray in the reflection direction. The shaded point <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-210" style="width: 0.679em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.604em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.58em 1000.6em 2.706em -999.996em); top: -2.474em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-family: STIXGeneral; font-style: italic;">P</span></span><span style="display: inline-block; width: 0px; height: 2.481em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.079em; border-left: 0px solid; width: 0px; height: 0.921em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">P</script> either takes on the color of the background if the reflection ray didn't intersect any geometry or the color of the object that the reflection ray intersected otherwise.</p>
</div>

<p>Simulating reflection in our ray-tracer is very simple. If the object that the primary ray hit is a mirror like surface, then we compute the reflection direction using the incident view direction (the primary ray direction) and the normal of the surface at the intersection point. We then call the <span class="code-inline">castRay()</span> function recursively (the function calls itself) and assign to the primary ray color the color of the reflected ray. The reflection ray can be called a <b>reflection</b> or also sometimes a <b>specular ray</b> (we will explain what the term specular means in more detail in the next chapter). Note that this technique can only produce perfectly sharp reflections. To learn how to produce <b>blurry</b> or <b>glossy reflections</b>, please refer to the next chapter or the second lesson on shading from this section. Because the plane in our example reflects the background color when it doesn't reflect the sphere, the plane and the background image wouldn't visually be distinguishable from each other. For this reason we reduce the brightness of the reflection by a small amount (20% in our example - line 24). This is not totally wrong, as mirror like surfaces generally never reflect 100% of the incident light anyway. The Fresnel effect which we will talk about later in this chapter can also have an effect on how much light a surface reflects.</p>

<div name="code" class="code"><div style="margin: 0px 10px; display: inline-block; float: left; width: auto; text-align: center; color: rgb(100, 100, 100);">001<br>002<br>003<br>004<br>005<br>006<br>007<br>008<br>009<br>010<br>011<br>012<br>013<br>014<br>015<br>016<br>017<br>018<br>019<br>020<br>021<br>022<br>023<br>024<br>025<br>026<br>027<br>028<br>029<br>030<br>031<br>032<br></div><div style="border-left: 1px solid rgb(100, 100, 100); padding-left: 10px; display: inline-block; width: auto; color: rgb(50, 50, 50);">Vec3f reflect(<b>const</b> Vec3f &amp;I, <b>const</b> Vec3f &amp;N) <br>{ <br>    <b>return</b> I - 2 * dotProduct(I, N) * N; <br>} <br> <br>Vec3f castRay( <br>    <b>const</b> Vec3f &amp;orig, <b>const</b> Vec3f &amp;dir, <br>    <b>const</b> std::vector&lt;std::unique_ptr&lt;Object&gt;&gt; &amp;objects, <br>    <b>const</b> std::vector&lt;std::unique_ptr&lt;Light&gt;&gt; &amp;lights, <br>    <b>const</b> Options &amp;options, <br>    <b>const</b> uint32_t &amp; depth = 0) <br>{ <br>    <b>if</b> (depth &gt; options.maxDepth) <b>return</b> options.backgroundColor; <br>    ... <br>    <b>if</b> (trace(orig, dir, objects, isect)) { <br>        ... <br>        switch (isect.hitObject-&gt;type) { <br>            case kDiffuse: <br>            ... <br>            case kReflection: <br>            { <br>                Vec3f R = reflect(dir, hitNormal); <br>                hitColor += 0.8 * castRay(hitPoint + hitNormal * options.bias, R, objects, lights, options, depth + 1); <br>                break; <br>            } <br>            ... <br>        } <br>    } <br>    ... <br> <br>    <b>return</b> hitColor; <br>} <br></div></div>

<div style="width: 400;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-reflection6.png"><p class="caption left">Figure 5:  reflection of the sphere in the plane. The attenuated the reflection to more easily differentiate the plane from the background.</p>
</div>

<div style="width: 400;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-reflection4.png"><p class="caption left">Figure 6:  reflection is a recursive process.</p>
</div>

<p>Note that the process is potentially <b>recursive</b>. It is entirely possible to have a situation in which a ray intersects a reflective surface from which we cast another reflection ray, that will intersect in turn another reflective surface, etc. In other words, the process will keep casting reflection rays unless the ray intersects an object which is not a mirror or if it doesn't intersect anything at all (in which case we return the background color). If a ray kept reflecting other reflecting surfaces without ever reflecting anything else, we would then enter some kind of infinite recursive process. To prevent this from happening, we generally put a cap or limit on the number of recursions. The number of times a reflection ray is reflected off of surfaces is called the <b>ray depth</b>. When we cast a reflection ray from the primary ray, we say that the ray has a depth of 1. After two reflections, the ray has a depth of 2 and so on. The ray depth is incremented each time we call the <span class="code-inline">castRay()</span> function recursively. At the beginning of the function (line 14), we test whether the ray depth is greater than the maximum ray depth allowed. If this is the case, we stop from going any further in the execution of the function and simply return the background color (as if the ray had not intersected any object at all). Of course, introducing this cap, means that our produced image will deviate from reality. Though for most scenes using a depth much greater than 4 or 5 generally doesn't make much of visual difference. It's only when very complex transparent surfaces are rendered (such as water splashes) that using a depth much greater than 5 is necessarily for producing images that are similar to the real thing. But these cases are hopefully generally rare. Keep in mind that another reason for putting a cap on the recursion depth is also because ray-tracing is expensive. The higher the recursion the longer it will take to render a frame. Setting the maximum recursion depth is always a trade-off between image quality and render time.</p>

<div class="important">Note that reflection (as many of the other shading effect we will study from now on) can be perfectly simulated with the ray-tracing algorithm. Remember that ray-tracing is essentially a technique for computing the visibility between two points. In this particular case, we compute the visibility between the point from which the ray is cast to the first surface that the ray intersects in the ray's direction (the reflection direction in this example). This is primarily why ray-tracing is better than rasterization for example when it comes to simulating effects such as reflection.</div>

<h2>Refraction</h2>

<div class="question">In this lesson, we will only deal with the case of clear transparent objects. For many transparent objects light is attenuated as it travels through the medium. In this lesson we will ignore the effect of light attenuation and absorption by a medium. You will find information on this effect in the advanced lessons on shading.</div>

<div style="width: 300;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction6.png"><p class="caption left">Figure 7: when light rays pass from one "transparent" medium to another, they change direction.</p>
</div>

<p>When light rays pass from one "transparent" medium to another, they change direction. This phenomenon is illustrated in figure 7. As you can see the light ray represented in this figure is bent at the boundary or interface between the two mediums (this can be air-glass, air-water, glass-water, etc.). The new direction of the ray depends on two factors. The ray angle of incidence and the new medium <b><a href="https://en.wikipedia.org/wiki/Refractive_index">refractive index</a></b> or <b>index of refraction</b> (also sometimes referred to as <b>ior</b>). The index of refraction for glass and water is around 1.5 and 1.3 respectively. For a fixed angle of incidence, the amount of bending depends on the index of refraction. (as shown in the image below).</p>

<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction3.png">

<p>When light travels in vacuum, we all know that it travels at the speed of light which is often denoted with the constant <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-213" style="width: 0.51em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000.45em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">c</script>. But when it travels through another medium, its speed decreases. If we denote the speed of light in this medium <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-216" style="width: 0.51em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000.45em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-217"><span class="mi" id="MathJax-Span-218" style="font-family: STIXGeneral; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">v</script>, then the index of refraction is simply the ratio of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-219" style="width: 0.51em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000.45em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-family: STIXGeneral; font-style: italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">c</script> over <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-222" style="width: 0.51em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000.45em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-223"><span class="mi" id="MathJax-Span-224" style="font-family: STIXGeneral; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">v</script>:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-225" style="width: 3.212em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 2.874em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.242em 1002.82em 3.437em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-226"><span class="mi" id="MathJax-Span-227" style="font-family: STIXGeneral; font-style: italic;">η</span><span class="mo" id="MathJax-Span-228" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-229" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-230"><span class="mfrac" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -4.671em; left: 50%; margin-left: -0.222em;"><span class="mi" id="MathJax-Span-232" style="font-family: STIXGeneral; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.319em; left: 50%; margin-left: -0.222em;"><span class="mi" id="MathJax-Span-233" style="font-family: STIXGeneral; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1000.57em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.566em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-234" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>η</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>c</mi><mi>v</mi></mfrac></mstyle><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">\eta= \dfrac{c}{v}.</script>

<div style="width: 300;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction1.jpg"><p class="caption left">Figure 8:  effect of refraction.</p>
</div>

<div style="width: 300;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction4.png"><p class="caption left">Figure 9:  effect of refraction (not the inverted image of the background scene in the glass ball).</p>
</div>

<div style="width: 300;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction5.png"><p class="caption left">Figure 10:  the reflection and refraction rays lie in the plane of incidence.</p>
</div>

<div style="width: 300;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction7.png"><p class="caption left">Figure 11:  compute the refraction ray direction using geometry.</p>
</div>

<p>Refraction indices are generally denoted with the letter <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-235" style="width: 0.51em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000.4em 2.931em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-236"><span class="mi" id="MathJax-Span-237" style="font-family: STIXGeneral; font-style: italic;">η</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">\eta</script> (the Greek letter eta). Light travels faster in water than in glass, but slower than in air (air has an refractive index very close to 1 and in CG we almost always treat air as if it was a vacuum). Refraction or the bending of light rays explains why objects seen through transparent objects such as glass or water, look deformed. It can create some really strange effects such as the illusion of a broken pen shown in figure 8. Looking at objects through a glass ball can inverse the image of the objects seen through the ball as shown in figure 9. These are some effects caused by refraction (which fits into the category of optical effects). Explaining the phenonemon of refraction is beyond the scope of this lesson. We will just stick for now to the equation that can be used to compute the refracted ray direction.</p>

<p>Refraction is described by the <b>Snell's law</b>, which states that for a given pair of media, the ratio of the sines of the angle of incidence <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-238" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.172em 1000.9em 1.354em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-239"><span class="msubsup" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-241" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-242" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">\theta_1</script> and angle of refraction <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-243" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.172em 1000.9em 1.354em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-244"><span class="msubsup" id="MathJax-Span-245"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-246" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-247" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">\theta_1</script> is equivalent to the opposite ratio of the indices of refraction (figure 7):</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-248" style="width: 6.084em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 5.465em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.016em 1005.41em 3.606em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-249"><span class="mstyle" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mfrac" id="MathJax-Span-252"><span style="display: inline-block; position: relative; width: 2.368em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1002.25em 4.338em -999.997em); top: -4.671em; left: 50%; margin-left: -1.123em;"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-255"></span><span class="msubsup" id="MathJax-Span-256" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-258" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1002.25em 4.338em -999.997em); top: -3.319em; left: 50%; margin-left: -1.123em;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-261"></span><span class="msubsup" id="MathJax-Span-262" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-263" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-264" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1002.37em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.368em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-266" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-267"><span class="mfrac" id="MathJax-Span-268"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-269"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-270" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-271" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -3.319em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-272"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-273" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-274" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1001.02em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.016em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-275" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>sin</mi><mo>⁡</mo><msub><mi>θ</mi><mn>1</mn></msub></mrow><mrow><mi>sin</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>η</mi><mn>2</mn></msub><msub><mi>η</mi><mn>1</mn></msub></mfrac></mstyle><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">\dfrac{\sin\theta_1}{\sin\theta_2} = \dfrac{\eta_2}{\eta_1}.</script>

<p>As you can see, the equation is really simple. We already know <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-276" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.172em 1000.9em 1.354em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-277"><span class="msubsup" id="MathJax-Span-278"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-279" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-280" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">\theta_1</script>, is the dot product between the incident ray direction and the surface normal as well as the refraction indices. Although how does it work in 3D space? In fact, if you look at figure 10, you can see that the incident ray, the reflected ray and the transmitted ray all lie in the same plane which is called the plane of incidence (in this plane lies the incident ray and the surface normal). In other words we can really think in terms of geometric construction in the plane of incidence. Look at figure 11. First, you can see that the vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-281" style="width: 0.678em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.62em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">T</script> the transmission ray that we want to build, is the sum of the vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-284" style="width: 0.678em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.57em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-family: STIXGeneral; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">A</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-287" style="width: 0.678em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.62em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289" style="font-family: STIXGeneral; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">B</script></p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-290" style="width: 5.07em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 4.564em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1004.51em 2.762em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-291"><span class="mi" id="MathJax-Span-292" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-293" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-294" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.341em;">A</span><span class="mo" id="MathJax-Span-295" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-296" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">B</span><span class="mo" id="MathJax-Span-297" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">T = A + B.</script>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-298" style="width: 0.678em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.57em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-family: STIXGeneral; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">A</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-301" style="width: 0.678em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.62em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-302"><span class="mi" id="MathJax-Span-303" style="font-family: STIXGeneral; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">B</script> can easily be computed using the following two equations:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-304" style="width: 7.829em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 7.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.735em 1006.82em 3.494em -999.997em); top: -2.362em; left: 0em;"><span class="mrow" id="MathJax-Span-305"><span class="mtable" id="MathJax-Span-306" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 6.703em; height: 0px;"><span style="position: absolute; clip: rect(2.48em 1006.65em 5.127em -999.997em); top: -3.995em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.703em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1005.97em 4.338em -999.997em); top: -4.671em; left: 0em;"><span class="mtd" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mi" id="MathJax-Span-309" style="font-family: STIXGeneral; font-style: italic;">A</span><span class="mo" id="MathJax-Span-310" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-311" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.341em;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mi" id="MathJax-Span-312" style="font-family: STIXGeneral; padding-left: 0.172em;">sin</span><span class="mo" id="MathJax-Span-313"></span><span class="mo" id="MathJax-Span-314" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-316" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-317" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-318" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-319" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1006.65em 4.338em -999.997em); top: -3.207em; left: 0em;"><span class="mtd" id="MathJax-Span-320"><span class="mrow" id="MathJax-Span-321"><span class="mi" id="MathJax-Span-322" style="font-family: STIXGeneral; font-style: italic;">B</span><span class="mo" id="MathJax-Span-323" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mo" id="MathJax-Span-324" style="font-family: STIXGeneral; padding-left: 0.341em;">−</span><span class="mi" id="MathJax-Span-325" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mi" id="MathJax-Span-326" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-327"></span><span class="mo" id="MathJax-Span-328" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-329"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-330" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-331" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-332" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-333" style="font-family: STIXGeneral;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>A</mi><mo>=</mo><mi>M</mi><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr><mtr><mtd><mi>B</mi><mo>=</mo><mo>−</mo><mi>N</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">
\begin{array}{l}
A = M\sin(\theta_2),\\
B = -N\cos(\theta_2).
\end{array}
</script>

<p>We already know about <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-334" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.74em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">N</script> but what about vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.9em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-family: STIXGeneral; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">M</script>? Well this vector can also be easily found by construction. You can see that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-340" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.9em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-341"><span class="mi" id="MathJax-Span-342" style="font-family: STIXGeneral; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">M</script> can be computed as follows:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-343" style="width: 6.365em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 5.746em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.016em 1005.69em 3.55em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-344"><span class="mi" id="MathJax-Span-345" style="font-family: STIXGeneral; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-346" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-347" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-348"><span class="mfrac" id="MathJax-Span-349"><span style="display: inline-block; position: relative; width: 2.987em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1002.82em 4.338em -999.997em); top: -4.671em; left: 50%; margin-left: -1.461em;"><span class="mrow" id="MathJax-Span-350"><span class="mo" id="MathJax-Span-351" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-352" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-353" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-354" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-355" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1002.71em 4.338em -999.997em); top: -3.319em; left: 50%; margin-left: -1.349em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-358"></span><span class="mo" id="MathJax-Span-359" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-360"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-361" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-362" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-363" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1002.99em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.987em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-364" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>M</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo stretchy="false">(</mo><mi>I</mi><mo>+</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">M = \dfrac{(I + C)}{\sin(\theta_1)}.</script>

<p>The first part of the equation is simple. The term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-365" style="width: 2.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.199em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.2em 2.762em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-366"><span class="mi" id="MathJax-Span-367" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-368" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-369" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo>+</mo><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">I + C</script> gives a vector perpendicular to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-370" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.74em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">N</script> or if you prefer to say it differently, tangent to the surface. Though this vector is normalized. To normalise it, you just need to divide it by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-373" style="width: 2.706em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.424em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.42em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-374"><span class="mi" id="MathJax-Span-375" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-376"></span><span class="mo" id="MathJax-Span-377" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-379" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-380" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-42">\sin(\theta_1</script>). You can see that the length of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-381" style="width: 2.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.199em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.2em 2.762em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-382"><span class="mi" id="MathJax-Span-383" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-384" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-385" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo>+</mo><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">I + C</script> is exactly equal to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-386" style="width: 3.1em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.762em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.71em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-387"><span class="mi" id="MathJax-Span-388" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-389"></span><span class="mo" id="MathJax-Span-390" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-391"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-392" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-393" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-394" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">\sin(\theta_1)</script>. If the length of the unnormalized vector is 0.7 and that you divide it by 0.7, its length after the division will be 1. The vector will be normalized. We have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-395" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.9em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-396"><span class="mi" id="MathJax-Span-397" style="font-family: STIXGeneral; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">M</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-398" style="width: 0.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.74em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-399"><span class="mi" id="MathJax-Span-400" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">N</script>. The vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-401" style="width: 0.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.678em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1000.68em 2.706em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-402"><span class="mi" id="MathJax-Span-403" style="font-family: STIXGeneral; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">C</script> is simply equal as usual to:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-404" style="width: 6.591em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 5.915em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1005.86em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-405"><span class="mi" id="MathJax-Span-406" style="font-family: STIXGeneral; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-407" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-408" style="font-family: STIXGeneral; padding-left: 0.341em;">cos</span><span class="mo" id="MathJax-Span-409"></span><span class="mo" id="MathJax-Span-410" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-411"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-412" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-413" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-414" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-415" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-416" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>C</mi><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>N</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">C = \cos(\theta_1)N.</script>

<p>If we put all these elements together we get:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-417" style="width: 18.471em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 16.613em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-1.968em 1016.39em 6.197em -999.997em); top: -2.362em; left: 0em;"><span class="mrow" id="MathJax-Span-418"><span class="mtable" id="MathJax-Span-419" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 16.275em; height: 0px;"><span style="position: absolute; clip: rect(4.507em 1016.22em 12.503em -999.997em); top: -8.668em; left: 0em;"><span style="display: inline-block; position: relative; width: 16.275em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1004.56em 4.338em -999.997em); top: -7.317em; left: 0em;"><span class="mtd" id="MathJax-Span-420"><span class="mrow" id="MathJax-Span-421"><span class="mi" id="MathJax-Span-422" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-423" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-424" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.341em;">A</span><span class="mo" id="MathJax-Span-425" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-426" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">B</span><span class="mo" id="MathJax-Span-427" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1010.93em 4.338em -999.997em); top: -5.909em; left: 0em;"><span class="mtd" id="MathJax-Span-428"><span class="mrow" id="MathJax-Span-429"><span class="mi" id="MathJax-Span-430" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-431" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-432" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.341em;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mi" id="MathJax-Span-433" style="font-family: STIXGeneral; padding-left: 0.172em;">sin</span><span class="mo" id="MathJax-Span-434"></span><span class="mo" id="MathJax-Span-435" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-436"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-437" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-438" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-439" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-440" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-441" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mi" id="MathJax-Span-442" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-443"></span><span class="mo" id="MathJax-Span-444" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-445"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-446" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-447" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-448" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-449" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.48em 1013.29em 5.014em -999.997em); top: -3.882em; left: 0em;"><span class="mtd" id="MathJax-Span-450"><span class="mrow" id="MathJax-Span-451"><span class="mi" id="MathJax-Span-452" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-453" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-454" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-455"><span class="mfrac" id="MathJax-Span-456"><span style="display: inline-block; position: relative; width: 5.915em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1005.75em 4.338em -999.997em); top: -4.671em; left: 50%; margin-left: -2.869em;"><span class="mrow" id="MathJax-Span-457"><span class="mo" id="MathJax-Span-458" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-459" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-460" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-461" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-462" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-463" style="font-family: STIXGeneral; padding-left: 0.172em;">sin</span><span class="mo" id="MathJax-Span-464"></span><span class="mo" id="MathJax-Span-465" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-466"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-467" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-468" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-469" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1002.71em 4.338em -999.997em); top: -3.319em; left: 50%; margin-left: -1.349em;"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-472"></span><span class="mo" id="MathJax-Span-473" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-474"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-475" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-476" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-477" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1005.91em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.915em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-478" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-479" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mi" id="MathJax-Span-480" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-481"></span><span class="mo" id="MathJax-Span-482" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-483"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-484" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-485" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-486" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-487" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.48em 1016.22em 5.014em -999.997em); top: -1.236em; left: 0em;"><span class="mtd" id="MathJax-Span-488"><span class="mrow" id="MathJax-Span-489"><span class="mi" id="MathJax-Span-490" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-491" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-492" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-493"><span class="mfrac" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 8.843em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1008.67em 4.338em -999.997em); top: -4.671em; left: 50%; margin-left: -4.389em;"><span class="mrow" id="MathJax-Span-495"><span class="mo" id="MathJax-Span-496" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-497" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-498" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-499" style="font-family: STIXGeneral; padding-left: 0.228em;">cos</span><span class="mo" id="MathJax-Span-500"></span><span class="mo" id="MathJax-Span-501" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-502"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-503" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-504" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-505" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-506" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-507" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-508" style="font-family: STIXGeneral; padding-left: 0.172em;">sin</span><span class="mo" id="MathJax-Span-509"></span><span class="mo" id="MathJax-Span-510" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-511"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-512" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-513" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-514" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1002.71em 4.338em -999.997em); top: -3.319em; left: 50%; margin-left: -1.349em;"><span class="mrow" id="MathJax-Span-515"><span class="mi" id="MathJax-Span-516" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-517"></span><span class="mo" id="MathJax-Span-518" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-519"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-520" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-521" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-522" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1008.84em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.843em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-523" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-524" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mi" id="MathJax-Span-525" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-526"></span><span class="mo" id="MathJax-Span-527" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-528"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-529" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-530" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-531" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-532" style="font-family: STIXGeneral;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.674em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -4.122em; border-left: 0px solid; width: 0px; height: 8.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>T</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo>,</mo></mtd></mtr><mtr><mtd><mi>T</mi><mo>=</mo><mi>M</mi><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mi>N</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr><mtr><mtd><mi>T</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo stretchy="false">(</mo><mi>I</mi><mo>+</mo><mi>C</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mo>−</mo><mi>N</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr><mtr><mtd><mi>T</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo stretchy="false">(</mo><mi>I</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>N</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mo>−</mo><mi>N</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-49">
\begin{array}{l}
T = A + B,\\
T = M\sin(\theta_2) - N\cos(\theta_2),\\
T = \dfrac{(I + C)\sin(\theta_2)}{\sin(\theta_1)} - N\cos(\theta_2),\\
T = \dfrac{(I + \cos(\theta_1)N)\sin(\theta_2)}{\sin(\theta_1)} - N\cos(\theta_2).
\end{array}
</script>

<p>We know that (Snell's law):</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-533" style="width: 6.647em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 5.971em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.016em 1005.91em 3.606em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-534"><span class="mstyle" id="MathJax-Span-535"><span class="mrow" id="MathJax-Span-536"><span class="mfrac" id="MathJax-Span-537"><span style="display: inline-block; position: relative; width: 2.874em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1002.71em 4.338em -999.997em); top: -4.671em; left: 50%; margin-left: -1.349em;"><span class="mrow" id="MathJax-Span-538"><span class="mi" id="MathJax-Span-539" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-540"></span><span class="mo" id="MathJax-Span-541" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-542"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-543" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-544" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-545" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1002.71em 4.338em -999.997em); top: -3.319em; left: 50%; margin-left: -1.349em;"><span class="mrow" id="MathJax-Span-546"><span class="mi" id="MathJax-Span-547" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-548"></span><span class="mo" id="MathJax-Span-549" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-550"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-551" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-552" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-553" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1002.87em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.874em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-554" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-555" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-556"><span class="mfrac" id="MathJax-Span-557"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-558"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-559" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-560" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -3.319em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-561"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-562" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-563" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1001.02em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.016em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-564" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><mrow><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>η</mi><mn>1</mn></msub><msub><mi>η</mi><mn>2</mn></msub></mfrac></mstyle><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">\dfrac{\sin(\theta_2)}{\sin(\theta_1)} = \dfrac{\eta_1}{\eta_2}.</script>

<p>Thus:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-565" style="width: 15.769em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 14.192em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.242em 1014.14em 3.606em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-566"><span class="mi" id="MathJax-Span-567" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-568" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-569" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-570"><span class="mfrac" id="MathJax-Span-571"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-572"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-573" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-574" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -3.319em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-575"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-576" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-577" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1001.02em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.016em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-578" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-579" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-580" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-581" style="font-family: STIXGeneral; padding-left: 0.228em;">cos</span><span class="mo" id="MathJax-Span-582"></span><span class="mo" id="MathJax-Span-583" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-584"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-585" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-586" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-587" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-588" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-589" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-590" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-591" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mi" id="MathJax-Span-592" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-593"></span><span class="mo" id="MathJax-Span-594" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-595"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-596" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-597" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-598" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-599" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>η</mi><mn>1</mn></msub><msub><mi>η</mi><mn>2</mn></msub></mfrac></mstyle><mo stretchy="false">(</mo><mi>I</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>N</mi><mo stretchy="false">)</mo><mo>−</mo><mi>N</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-51">T = \dfrac{\eta_1}{\eta_2}(I + \cos(\theta_1)N) - N\cos(\theta_2).</script>

<p>We also know that:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/msqrt&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-600" style="width: 21.962em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 19.766em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.129em 1019.71em 3.269em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-601"><span class="msubsup" id="MathJax-Span-602"><span style="display: inline-block; position: relative; width: 1.748em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1001.3em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-603" style="font-family: STIXGeneral;">cos</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.389em; left: 1.354em;"><span class="mn" id="MathJax-Span-604" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-605"></span><span class="mo" id="MathJax-Span-606" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-607" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-608" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-609" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="msubsup" id="MathJax-Span-610" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 1.579em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1001.13em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-611" style="font-family: STIXGeneral;">sin</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.389em; left: 1.185em;"><span class="mn" id="MathJax-Span-612" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-613"></span><span class="mo" id="MathJax-Span-614" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-615" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-616" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-617" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mn" id="MathJax-Span-618" style="font-family: STIXGeneral; padding-left: 0.341em;">1</span><span class="mo" id="MathJax-Span-619" style="font-family: STIXGeneral; padding-left: 0.341em;">→</span><span class="mi" id="MathJax-Span-620" style="font-family: STIXGeneral; padding-left: 0.341em;">cos</span><span class="mo" id="MathJax-Span-621"></span><span class="mo" id="MathJax-Span-622" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-623" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-624" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-625" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="msqrt" id="MathJax-Span-626" style="padding-left: 0.341em;"><span style="display: inline-block; position: relative; width: 5.465em; height: 0px;"><span style="position: absolute; clip: rect(2.931em 1004.34em 4.338em -999.997em); top: -3.995em; left: 1.073em;"><span class="mrow" id="MathJax-Span-627"><span class="mn" id="MathJax-Span-628" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-629" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-630" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 1.579em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1001.13em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-631" style="font-family: STIXGeneral;">sin</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.389em; left: 1.185em;"><span class="mn" id="MathJax-Span-632" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-633"></span><span class="mo" id="MathJax-Span-634" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-635" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-636" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.987em 1004.45em 3.381em -999.997em); top: -4.389em; left: 1.073em;"><span style="display: inline-block; position: relative; width: 4.451em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.995em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.995em; left: 3.944em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 0.397em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 0.847em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 1.298em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 1.748em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 2.142em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 2.593em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 3.043em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 3.494em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.255em 1001.07em 4.451em -999.997em); top: -3.713em; left: 0em;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-637" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>cos</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo stretchy="false">→</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msqrt><mn>1</mn><mo>−</mo><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></msqrt><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-52">\cos^2(\theta) + \sin^2(\theta) = 1 \rightarrow \cos(\theta) = \sqrt{1 - \sin^2(\theta)}.</script>

<p>And since:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-638" style="width: 9.293em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 8.336em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.242em 1008.28em 3.606em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-639"><span class="mi" id="MathJax-Span-640" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-641"></span><span class="mo" id="MathJax-Span-642" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-643"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-644" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-645" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-646" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-647" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-648" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-649"><span class="mfrac" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-651"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-652" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-653" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -3.319em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-654"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-655" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-656" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1001.02em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.016em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-657" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-658"></span><span class="mo" id="MathJax-Span-659" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-660"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-661" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-662" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-663" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-664" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>η</mi><mn>1</mn></msub><msub><mi>η</mi><mn>2</mn></msub></mfrac></mstyle><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-53">\sin(\theta_2) = \dfrac{\eta_1}{\eta_2} \sin(\theta_1).</script>

<p>We finally have:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/msqrt&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-665" style="width: 22.525em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 20.273em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.566em 1020.22em 4.001em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-666"><span class="mi" id="MathJax-Span-667" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-668" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-669" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-670"><span class="mfrac" id="MathJax-Span-671"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-672"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-673" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-674" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -3.319em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-675"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-676" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-677" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1001.02em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.016em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-678" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-679" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-680" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mi" id="MathJax-Span-681" style="font-family: STIXGeneral; padding-left: 0.228em;">cos</span><span class="mo" id="MathJax-Span-682"></span><span class="mo" id="MathJax-Span-683" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-684"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-685" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-686" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-687" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-688" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-689" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-690" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-691" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="msqrt" id="MathJax-Span-692"><span style="display: inline-block; position: relative; width: 9.124em; height: 0px;"><span style="position: absolute; clip: rect(2.368em 1007.94em 5.07em -999.997em); top: -3.995em; left: 1.073em;"><span class="mrow" id="MathJax-Span-693"><span class="mn" id="MathJax-Span-694" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-695" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-696" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 3.043em; height: 0px;"><span style="position: absolute; clip: rect(2.537em 1002.42em 5.07em -999.997em); top: -3.995em; left: 0em;"><span class="mrow" id="MathJax-Span-697"><span class="mo" id="MathJax-Span-698" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">(</span></span></span><span class="mstyle" id="MathJax-Span-699"><span class="mrow" id="MathJax-Span-700"><span class="mfrac" id="MathJax-Span-701"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-702"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-703" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-704" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -3.319em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-705"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-706" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-707" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1001.02em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.016em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-708" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -5.008em; left: 2.593em;"><span class="mn" id="MathJax-Span-709" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-710" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 1.579em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1001.13em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-711" style="font-family: STIXGeneral;">sin</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.389em; left: 1.185em;"><span class="mn" id="MathJax-Span-712" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-713"></span><span class="mo" id="MathJax-Span-714" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-715"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-716" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-717" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-718" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.987em 1008.05em 3.381em -999.997em); top: -4.952em; left: 1.073em;"><span style="display: inline-block; position: relative; width: 8.055em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.995em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.995em; left: 7.548em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 0.397em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 0.847em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 1.298em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 1.748em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 2.199em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 2.649em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 3.1em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 3.55em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 4.001em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 4.395em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 4.845em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 5.296em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 5.746em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 6.197em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 6.647em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 7.097em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(1.298em 1001.13em 4.733em -999.997em); top: -3.319em; left: 0em;"><span style="font-family: STIXSizeThreeSym;">√</span><span style="display: inline-block; width: 0px; height: 4.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-719" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 3.566em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>η</mi><mn>1</mn></msub><msub><mi>η</mi><mn>2</mn></msub></mfrac></mstyle><mo stretchy="false">(</mo><mi>I</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>N</mi><mo stretchy="false">)</mo><mo>−</mo><mi>N</mi><msqrt><mn>1</mn><mo>−</mo><msup><mrow><mo>(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>η</mi><mn>1</mn></msub><msub><mi>η</mi><mn>2</mn></msub></mfrac></mstyle><mo>)</mo></mrow><mn>2</mn></msup><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></msqrt><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-54">T = \dfrac{\eta_1}{\eta_2}(I + \cos(\theta_1)N) - N\sqrt{1 - \left( \dfrac{\eta_1}{\eta_2} \right) ^2 \sin^2(\theta_1)}.</script>

<p>If we write:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/msqrt&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msqrt&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/msqrt&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-720" style="width: 27.48em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 24.721em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-1.574em 1024.55em 5.802em -999.997em); top: -2.362em; left: 0em;"><span class="mrow" id="MathJax-Span-721"><span class="mtable" id="MathJax-Span-722" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 24.383em; height: 0px;"><span style="position: absolute; clip: rect(4.057em 1024.38em 11.433em -999.997em); top: -7.993em; left: 0em;"><span style="display: inline-block; position: relative; width: 24.383em; height: 0px;"><span style="position: absolute; clip: rect(2.706em 1003.33em 5.07em -999.997em); top: -6.641em; left: 0em;"><span class="mtd" id="MathJax-Span-723"><span class="mrow" id="MathJax-Span-724"><span class="mi" id="MathJax-Span-725" style="font-family: STIXGeneral; font-style: italic;">η</span><span class="mo" id="MathJax-Span-726" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-727" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-728"><span class="mfrac" id="MathJax-Span-729"><span style="display: inline-block; position: relative; width: 1.016em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-730"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-731" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-732" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.9em 4.395em -999.997em); top: -3.319em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-733"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-734" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-735" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1001.02em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.016em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-736" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1008.56em 4.338em -999.997em); top: -4.502em; left: 0em;"><span class="mtd" id="MathJax-Span-737"><span class="mrow" id="MathJax-Span-738"><span class="msubsup" id="MathJax-Span-739"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-740" style="font-family: STIXGeneral; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-741" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-742" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-743" style="font-family: STIXGeneral; padding-left: 0.341em;">cos</span><span class="mo" id="MathJax-Span-744"></span><span class="mo" id="MathJax-Span-745" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-746"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-747" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-748" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-749" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-750" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-751" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.341em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-752" style="font-family: STIXGeneral; padding-left: 0.228em;">⋅</span><span class="mi" id="MathJax-Span-753" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-754" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.03em 1024.38em 5.408em -999.997em); top: -2.024em; left: 0em;"><span class="mtd" id="MathJax-Span-755"><span class="mrow" id="MathJax-Span-756"><span class="msubsup" id="MathJax-Span-757"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-758" style="font-family: STIXGeneral; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-759" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-760" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="msqrt" id="MathJax-Span-761" style="padding-left: 0.341em;"><span style="display: inline-block; position: relative; width: 9.124em; height: 0px;"><span style="position: absolute; clip: rect(2.368em 1008em 5.014em -999.997em); top: -3.995em; left: 1.073em;"><span class="mrow" id="MathJax-Span-762"><span class="mn" id="MathJax-Span-763" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-764" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-765" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 3.043em; height: 0px;"><span style="position: absolute; clip: rect(2.537em 1002.48em 5.014em -999.997em); top: -3.995em; left: 0em;"><span class="mrow" id="MathJax-Span-766"><span class="mo" id="MathJax-Span-767" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">(</span></span></span><span class="mstyle" id="MathJax-Span-768"><span class="mrow" id="MathJax-Span-769"><span class="mfrac" id="MathJax-Span-770"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.9em 4.338em -999.997em); top: -4.671em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-771"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-772" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-773" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.9em 4.338em -999.997em); top: -3.319em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-774"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-775" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-776" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1001.07em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.073em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-777" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -5.008em; left: 2.593em;"><span class="mn" id="MathJax-Span-778" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-779" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 1.579em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1001.13em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-780" style="font-family: STIXGeneral;">sin</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.389em; left: 1.185em;"><span class="mn" id="MathJax-Span-781" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-782"></span><span class="mo" id="MathJax-Span-783" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-784"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-785" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-786" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-787" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.987em 1008.05em 3.381em -999.997em); top: -5.008em; left: 1.073em;"><span style="display: inline-block; position: relative; width: 8.055em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.995em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.995em; left: 7.548em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 0.397em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 0.847em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 1.298em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 1.748em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 2.199em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 2.649em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 3.1em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 3.55em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 4.001em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 4.451em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 4.901em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 5.352em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 5.746em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 6.197em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 6.647em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 7.097em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(1.298em 1001.13em 4.733em -999.997em); top: -3.376em; left: 0em;"><span style="font-family: STIXSizeThreeSym;">√</span><span style="display: inline-block; width: 0px; height: 4.057em;"></span></span></span></span><span class="mo" id="MathJax-Span-788" style="font-family: STIXGeneral; padding-left: 0.341em;">→</span><span class="msqrt" id="MathJax-Span-789" style="padding-left: 0.341em;"><span style="display: inline-block; position: relative; width: 11.433em; height: 0px;"><span style="position: absolute; clip: rect(2.368em 1010.31em 5.014em -999.997em); top: -3.995em; left: 1.073em;"><span class="mrow" id="MathJax-Span-790"><span class="mn" id="MathJax-Span-791" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-792" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-793" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 3.043em; height: 0px;"><span style="position: absolute; clip: rect(2.537em 1002.48em 5.014em -999.997em); top: -3.995em; left: 0em;"><span class="mrow" id="MathJax-Span-794"><span class="mo" id="MathJax-Span-795" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">(</span></span></span><span class="mstyle" id="MathJax-Span-796"><span class="mrow" id="MathJax-Span-797"><span class="mfrac" id="MathJax-Span-798"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.381em 1000.9em 4.338em -999.997em); top: -4.671em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-799"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-800" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-801" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.381em 1000.9em 4.338em -999.997em); top: -3.319em; left: 50%; margin-left: -0.448em;"><span class="msubsup" id="MathJax-Span-802"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-803" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-804" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1001.07em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.073em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-805" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -5.008em; left: 2.593em;"><span class="mn" id="MathJax-Span-806" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-807" style="font-family: STIXGeneral;">(</span><span class="mn" id="MathJax-Span-808" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-809" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-810" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 1.748em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1001.3em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-811" style="font-family: STIXGeneral;">cos</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -4.276em; left: 1.354em;"><span class="mn" id="MathJax-Span-812" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-813"></span><span class="mo" id="MathJax-Span-814" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-815"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-816" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-817" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-818" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-819" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.987em 1010.36em 3.381em -999.997em); top: -5.008em; left: 1.073em;"><span style="display: inline-block; position: relative; width: 10.363em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.995em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.995em; left: 9.856em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 0.453em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 0.904em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 1.298em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 1.748em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 2.199em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 2.649em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 3.1em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 3.55em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 4.001em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 4.451em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 4.901em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 5.352em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 5.802em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 6.253em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 6.703em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 7.154em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 7.604em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 8.055em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 8.505em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 8.956em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.995em; left: 9.406em;">‾<span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(1.298em 1001.13em 4.733em -999.997em); top: -3.376em; left: 0em;"><span style="font-family: STIXSizeThreeSym;">√</span><span style="display: inline-block; width: 0px; height: 4.057em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.684em; border-left: 0px solid; width: 0px; height: 7.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>η</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>η</mi><mn>1</mn></msub><msub><mi>η</mi><mn>2</mn></msub></mfrac></mstyle><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>N</mi><mo>⋅</mo><mi>I</mi><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>c</mi><mn>2</mn></msub><mo>=</mo><msqrt><mn>1</mn><mo>−</mo><msup><mrow><mo>(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>n</mi><mn>1</mn></msub><msub><mi>n</mi><mn>2</mn></msub></mfrac></mstyle><mo>)</mo></mrow><mn>2</mn></msup><msup><mi>sin</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></msqrt><mo stretchy="false">→</mo><msqrt><mn>1</mn><mo>−</mo><msup><mrow><mo>(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msub><mi>n</mi><mn>1</mn></msub><msub><mi>n</mi><mn>2</mn></msub></mfrac></mstyle><mo>)</mo></mrow><mn>2</mn></msup><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>cos</mi><mn>2</mn></msup><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></msqrt></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-55">
\begin{array}{l}
\eta = \dfrac{\eta_1}{\eta_2},\\
c_1 = \cos(\theta_1) = N \cdot I,\\
c_2 = \sqrt{1 - \left( \dfrac{n_1}{n_2} \right) ^2 \sin^2(\theta_1)} \rightarrow \sqrt{1 - \left( \dfrac{n_1}{n_2} \right) ^2 (1 - \cos^2(\theta_1))}
\end{array}
</script>

<p>Then:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-820" style="width: 10.645em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 9.575em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.735em 1009.35em 3.494em -999.997em); top: -2.362em; left: 0em;"><span class="mrow" id="MathJax-Span-821"><span class="mtable" id="MathJax-Span-822" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 9.237em; height: 0px;"><span style="position: absolute; clip: rect(2.48em 1009.18em 5.127em -999.997em); top: -3.995em; left: 0em;"><span style="display: inline-block; position: relative; width: 9.237em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1009.18em 4.395em -999.997em); top: -4.671em; left: 0em;"><span class="mtd" id="MathJax-Span-823"><span class="mrow" id="MathJax-Span-824"><span class="mi" id="MathJax-Span-825" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-826" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-827" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.341em;">η</span><span class="mo" id="MathJax-Span-828" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-829" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-830" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="msubsup" id="MathJax-Span-831" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-832" style="font-family: STIXGeneral; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-833" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-834" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-835" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-836" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="mi" id="MathJax-Span-837" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.228em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="msubsup" id="MathJax-Span-838"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-839" style="font-family: STIXGeneral; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-840" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-841" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1008.96em 4.395em -999.997em); top: -3.207em; left: 0em;"><span class="mtd" id="MathJax-Span-842"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-845" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mi" id="MathJax-Span-846" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.341em;">η</span><span class="mi" id="MathJax-Span-847" style="font-family: STIXGeneral; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-848" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="mo" id="MathJax-Span-849" style="font-family: STIXGeneral; padding-left: 0.228em;">(</span><span class="mi" id="MathJax-Span-850" style="font-family: STIXGeneral; font-style: italic;">η</span><span class="msubsup" id="MathJax-Span-851"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-852" style="font-family: STIXGeneral; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-853" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-854" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-855" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-856" style="font-family: STIXGeneral; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-857" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-858" style="font-family: STIXGeneral;">)</span><span class="mi" id="MathJax-Span-859" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span class="mo" id="MathJax-Span-860" style="font-family: STIXGeneral;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>T</mi><mo>=</mo><mi>η</mi><mo stretchy="false">(</mo><mi>I</mi><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>N</mi><mo stretchy="false">)</mo><mo>−</mo><mi>N</mi><msub><mi>c</mi><mn>2</mn></msub><mo>,</mo></mtd></mtr><mtr><mtd><mi>T</mi><mo>=</mo><mi>η</mi><mi>I</mi><mo>+</mo><mo stretchy="false">(</mo><mi>η</mi><msub><mi>c</mi><mn>1</mn></msub><mo>−</mo><msub><mi>c</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>N</mi><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-56">
\begin{array}{l}
T = \eta(I + c_1 N) - N c_2,\\
T = \eta I + (\eta c_1 - c_2) N.
\end{array}
</script>

<div style="width: 300;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction8.png"><p class="caption left">Figure 12:  is the incident ray inside or outside the medium with the highest refraction index? If inside the object and leaving it, we then need to flip the normal direction to compute the refraction direction.</p>
</div>

<p>Maybe you should take a moment to contemplate the beauty of nature (and of mathematics). It was quite astonishing to think that light follows such simple mathematic geometric rules and yet, what causes the phenomenon of refraction is quite a complex physical effect. Congratulations, you now can compute the direction of the refracted ray. There are a couple of details we need to take care of though in the actual implementation of this equation. First in some cases the ray will hit the surface from outside. This is the case when the light ray enters a volume of water for example. But when the ray leaves that volume of water, the normal will be pointing on the other side of the water surface. In this particular case if we want our equation to work we will need to invert the normal direction. Finding if the incident ray hits the surface from outside or inside can simply be done by checking the sign of the dot product between the normal and the incident ray direction (as shown in figure 12). Keep in mind that the result of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-861" style="width: 2.874em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.593em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.59em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-862"><span class="mi" id="MathJax-Span-863" style="font-family: STIXGeneral;">cos</span><span class="mo" id="MathJax-Span-864"></span><span class="mo" id="MathJax-Span-865" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-866"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-867" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-868" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">\cos(\theta_1</script>) also needs to be positive. If it is negative (if the incident ray hits the surface from outside) we will need to reverse the sign of the dot product. Finally keep in mind that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-869" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.397em 1000.9em 1.41em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-870"><span class="msubsup" id="MathJax-Span-871"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-872" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-873" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>η</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">\eta_1</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-874" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.397em 1000.9em 1.41em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-875"><span class="msubsup" id="MathJax-Span-876"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-877" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-878" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>η</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">\eta_2</script> are the refraction indices of the first and second medium respectively. If the ray leaves the second medium and enter the first one, we will need to inverse the order of the two medium refraction index to compute <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-879" style="width: 0.51em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.453em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em 1000.4em 2.931em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-880"><span class="mi" id="MathJax-Span-881" style="font-family: STIXGeneral; font-style: italic;">η</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>η</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">\eta</script>.</p>

<div name="code" class="code"><div style="margin: 0px 10px; display: inline-block; float: left; width: auto; text-align: center; color: rgb(100, 100, 100);">001<br>002<br>003<br>004<br>005<br>006<br>007<br>008<br>009<br>010<br>011<br>012<br>013<br>014<br>015<br>016<br>017<br>018<br></div><div style="border-left: 1px solid rgb(100, 100, 100); padding-left: 10px; display: inline-block; width: auto; color: rgb(50, 50, 50);">Vec3f refract(<b>const</b> Vec3f &amp;I, <b>const</b> Vec3f &amp;N, <b>const</b> <b>float</b> &amp;ior) <br>{ <br>    Vec3f Nrefr = N; <br>    <b>float</b> NdotI = Nrefr.dotProduct(I); <br>    <b>float</b> etai = 1, etat = ior; // etai is the index of refraction of the medium the ray is in before entering the second medium <br>    <b>if</b> (NdotI &lt; 0) { <br>        <span style="color: rgb(100, 100, 100);">// we are outside the surface, we want cos(theta) to be positive</span><br>        NdotI = -NdotI; <br>    } <br>    else { <br>        <span style="color: rgb(100, 100, 100);">// we are inside the surface, cos(theta) is already positive but reverse normal direction</span><br>        Nrefr = -N; <br>        <span style="color: rgb(100, 100, 100);">// swap the refraction indices</span><br>        std::swap(etai, etat); <br>    } <br>    <b>float</b> eta = etai / etat; // n_1 / n_2 <br>    ... <br>} <br></div></div>

<p>In this particular piece of code, <span class="code-inline">ior</span> is the refraction index of the material of the <b>physical object</b> the ray has either hit or is about to leave (glass, water, etc.). As stated before air has a refraction index close to 1, and for this reason, in CG, we generally ignore it. We treat air as if it was a vacuum.</p>

<div style="width: 300;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction10.png"><p class="caption left">Figure 13:  total internal reflection.</p>
</div>

<p>One final detail needs to be accounted for. When the angle of incident is greater than some value called the <b>critical angle</b>, then 100% of the light incident on the surface is reflected. In another words, when the angle of incident is greater than the critical angle, there isn't any refraction at all. This only happens though when the light ray passes from one medium to another medium with a lower index of refraction, such as in the case of a water-air, diamond-water or glass-water interaction. This phenomenon is called <b>total internal reflection</b>.</p>

<img class="left" style="margin-bottom: 12px;" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction9.png">

<p>We can compute this angle if desired, though when we compute the refraction direction, there is a simpler way of knowing when this happens. It happens when the term within the square root of the term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-882" style="width: 0.96em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.397em 1000.85em 1.354em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-883"><span class="msubsup" id="MathJax-Span-884"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-885" style="font-family: STIXGeneral; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-886" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-61">c_2</script> is negative (the square root in this case is a negative number or imaginary):</p>

<div name="code" class="code"><div style="margin: 0px 10px; display: inline-block; float: left; width: auto; text-align: center; color: rgb(100, 100, 100);">001<br>002<br>003<br>004<br>005<br>006<br>007<br>008<br>009<br>010<br>011<br></div><div style="border-left: 1px solid rgb(100, 100, 100); padding-left: 10px; display: inline-block; width: auto; color: rgb(50, 50, 50);">Vec3f refract(<b>const</b> Vec3f &amp;I, <b>const</b> Vec3f &amp;N, <b>const</b> <b>float</b> &amp;ior) <br>{ <br>    Vec3f Nrefr = N; <br>    ... <br>    <b>float</b> k = 1 - eta * eta * (1 - cosi * cosi); <br>    <b>if</b> (k &lt; 0) <br>        <span style="color: rgb(100, 100, 100);">// total internal reflection. There is no refraction in this case</span><br>        <b>return</b> 0; <br>    else <br>        eta * I + (eta * NdotI - sqrtf(k)) * Nrefr ; <br>} <br></div></div>

<div class="question">There is another way of computing or finding out when the incident light is totally reflected rather than being refracted. You need to compute the sine of the angle of refraction. If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-887" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.255em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.676em 1002.25em 2.899em -999.997em); top: -2.571em; left: 0em;"><span class="mrow" id="MathJax-Span-888"><span class="mi" id="MathJax-Span-889" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-890"></span><span class="msubsup" id="MathJax-Span-891" style="padding-left: 0.196em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.092em 1000.52em 4.186em -999.997em); top: -3.986em; left: 0em;"><span class="mi" id="MathJax-Span-892" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.858em; left: 0.454em;"><span class="mn" id="MathJax-Span-893" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.577em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>sin</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-62">\sin\theta_2</script> is greater than 1, then we have a case of total internal reflection. Note that this value can easily be computed using Snell's law:
<div style="width: 660px;" class="code-basic">float sint = etai / etat * sqrtf(std::max(0.f, 1 - cosi * cosi));</div>
</div>

<p>Finally here is a complete implementation of the refraction function:</p>

<div name="code" class="code"><div style="margin: 0px 10px; display: inline-block; float: left; width: auto; text-align: center; color: rgb(100, 100, 100);">001<br>002<br>003<br>004<br>005<br>006<br>007<br>008<br>009<br>010<br></div><div style="border-left: 1px solid rgb(100, 100, 100); padding-left: 10px; display: inline-block; width: auto; color: rgb(50, 50, 50);">Vec3f refract(<b>const</b> Vec3f &amp;I, <b>const</b> Vec3f &amp;N, <b>const</b> <b>float</b> &amp;ior) <br>{ <br>    <b>float</b> cosi = clamp(-1, 1, dotProduct(I, N)); <br>    <b>float</b> etai = 1, etat = ior; <br>    Vec3f n = N; <br>    <b>if</b> (cosi &lt; 0) { cosi = -cosi; } else { std::swap(etai, etat); n= -N; } <br>    <b>float</b> eta = etai / etat; <br>    <b>float</b> k = 1 - eta * eta * (1 - cosi * cosi); <br>    <b>return</b> k &lt; 0 ? 0 : eta * I + (eta * cosi - sqrtf(k)) * n; <br>} <br></div></div>

<div style="width: 300;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction12.png"><p class="caption left">Figure 14:  refraction of the plane in the sphere.</p>
</div>

<p>You can see a render of a glass sphere on the right. As in the example of the real glass ball from figure 9, you can see that the image of the background geometry is inverted in the sphere. If you follow the path of the refracted rays through the ball, you will understand why. The problem with this image though, is that it is not completely realistic. Glass spheres as well as pretty much every other transparent surface (water, diamonds, crystal, etc.) transmit as well as reflect light. They are both refractive and reflective. The problem is how do we know how much light they transmit vs. the amount of light they reflect? This ratio is actually given by the <b>Fresnel equations</b> which we will study next.</p>

<h2>Fresnel</h2>

<p>As mentioned just above, transparent objects such as glass or water are both refractive and reflective. How much light they reflect vs the amount they transmit actually depends on the angle of incidence. The amount of transmitted light increases when the angle of incidence decreases. And since by the principle of the conservation of energy, the amount of reflected light plus the amount of refracted light is necessary equal to the total amount of incident light, you can deduce that the amount of reflected light increases when the angle of incidence increases, up to 100% as the angle gets closer to 90 degrees. Technically, the edges of a glass ball are 100% reflective. In its center though, the sphere only reflects about 6% of the incident light.</p>

<p>The amount of reflected vs. refracted light can be computed using what we call the <b>Fresnel equations</b>. Explaining the origin of these equations and how they can be derived goes far beyond the level of explanation we are willing to give in this lesson. Light is composed of two perpendicular waves which we call parallel and perpendicular polarised light. Don't worry too much if you don't know about this detail. Suffice to know that we need to compute the ratio of reflected light for these two waves using two different equations (one for each type of wave) and average the results to find the solution. The two Fresnel equations are:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2225;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;&amp;#x22A5;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-894" style="width: 15.318em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 13.798em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.729em 1013.57em 4.958em -999.997em); top: -2.362em; left: 0em;"><span class="mrow" id="MathJax-Span-895"><span class="mtable" id="MathJax-Span-896" style="padding-right: 0.172em; padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 13.46em; height: 0px;"><span style="position: absolute; clip: rect(3.269em 1013.4em 8.956em -999.997em); top: -6.36em; left: 0em;"><span style="display: inline-block; position: relative; width: 13.46em; height: 0px;"><span style="position: absolute; clip: rect(2.255em 1013.29em 5.07em -999.997em); top: -5.346em; left: 0em;"><span class="mtd" id="MathJax-Span-897"><span class="mrow" id="MathJax-Span-898"><span class="msubsup" id="MathJax-Span-899"><span style="display: inline-block; position: relative; width: 1.467em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.62em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-900" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="texatom" id="MathJax-Span-901"><span class="mrow" id="MathJax-Span-902"><span class="mi" id="MathJax-Span-903" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">R</span><span class="mo" id="MathJax-Span-904" style="font-size: 70.7%; font-family: STIXGeneral;">∥</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-905" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="msubsup" id="MathJax-Span-906" style="padding-left: 0.341em;"><span style="display: inline-block; position: relative; width: 10.251em; height: 0px;"><span style="position: absolute; clip: rect(2.48em 1009.69em 5.07em -999.997em); top: -3.995em; left: 0em;"><span class="mrow" id="MathJax-Span-907"><span class="mo" id="MathJax-Span-908" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">(</span></span></span><span class="mstyle" id="MathJax-Span-909"><span class="mrow" id="MathJax-Span-910"><span class="mfrac" id="MathJax-Span-911"><span style="display: inline-block; position: relative; width: 8.224em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1008.11em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -4.051em;"><span class="mrow" id="MathJax-Span-912"><span class="msubsup" id="MathJax-Span-913"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-914" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-915" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-916" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-917"></span><span class="msubsup" id="MathJax-Span-918" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-919" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-920" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-921" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-922" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-923" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-924" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-925" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-926"></span><span class="msubsup" id="MathJax-Span-927" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-928" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-929" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1008.11em 4.395em -999.997em); top: -3.319em; left: 50%; margin-left: -4.051em;"><span class="mrow" id="MathJax-Span-930"><span class="msubsup" id="MathJax-Span-931"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-932" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-933" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-934" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-935"></span><span class="msubsup" id="MathJax-Span-936" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-937" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-938" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-939" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="msubsup" id="MathJax-Span-940" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-941" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-942" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-943" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-944"></span><span class="msubsup" id="MathJax-Span-945" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-946" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-947" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1008.22em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.224em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-948" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -5.065em; left: 9.8em;"><span class="mn" id="MathJax-Span-949" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-950" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(2.255em 1013.4em 5.07em -999.997em); top: -2.475em; left: 0em;"><span class="mtd" id="MathJax-Span-951"><span class="mrow" id="MathJax-Span-952"><span class="msubsup" id="MathJax-Span-953"><span style="display: inline-block; position: relative; width: 1.579em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.62em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-954" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="texatom" id="MathJax-Span-955"><span class="mrow" id="MathJax-Span-956"><span class="mi" id="MathJax-Span-957" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">R</span><span class="mo" id="MathJax-Span-958" style="font-size: 70.7%; font-family: STIXGeneral;">⊥</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-959" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="msubsup" id="MathJax-Span-960" style="padding-left: 0.341em;"><span style="display: inline-block; position: relative; width: 10.251em; height: 0px;"><span style="position: absolute; clip: rect(2.48em 1009.69em 5.07em -999.997em); top: -3.995em; left: 0em;"><span class="mrow" id="MathJax-Span-961"><span class="mo" id="MathJax-Span-962" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">(</span></span></span><span class="mstyle" id="MathJax-Span-963"><span class="mrow" id="MathJax-Span-964"><span class="mfrac" id="MathJax-Span-965"><span style="display: inline-block; position: relative; width: 8.224em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1008.11em 4.395em -999.997em); top: -4.671em; left: 50%; margin-left: -4.051em;"><span class="mrow" id="MathJax-Span-966"><span class="msubsup" id="MathJax-Span-967"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-968" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-969" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-970" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-971"></span><span class="msubsup" id="MathJax-Span-972" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-973" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-974" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-975" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-976" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-977" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-978" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-979" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-980"></span><span class="msubsup" id="MathJax-Span-981" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-982" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-983" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1008.11em 4.395em -999.997em); top: -3.319em; left: 50%; margin-left: -4.051em;"><span class="mrow" id="MathJax-Span-984"><span class="msubsup" id="MathJax-Span-985"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-986" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-987" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-988" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-989"></span><span class="msubsup" id="MathJax-Span-990" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-991" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-992" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-993" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="msubsup" id="MathJax-Span-994" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-995" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-996" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mi" id="MathJax-Span-997" style="font-family: STIXGeneral; padding-left: 0.172em;">cos</span><span class="mo" id="MathJax-Span-998"></span><span class="msubsup" id="MathJax-Span-999" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1000" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-1001" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1008.22em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.224em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1002" style="vertical-align: -0.448em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -5.065em; left: 9.8em;"><span class="mn" id="MathJax-Span-1003" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-1004" style="font-family: STIXGeneral;">.</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.365em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.368em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.747em; border-left: 0px solid; width: 0px; height: 6.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><msub><mi>F</mi><mrow class="MJX-TeXAtom-ORD"><mi>R</mi><mo stretchy="false">∥</mo></mrow></msub><mo>=</mo><msup><mrow><mo>(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>η</mi><mn>2</mn></msub><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>−</mo><msub><mi>η</mi><mn>1</mn></msub><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub></mrow><mrow><msub><mi>η</mi><mn>2</mn></msub><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>η</mi><mn>1</mn></msub><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub></mrow></mfrac></mstyle><mo>)</mo></mrow><mn>2</mn></msup><mo>,</mo></mtd></mtr><mtr><mtd><msub><mi>F</mi><mrow class="MJX-TeXAtom-ORD"><mi>R</mi><mo>⊥</mo></mrow></msub><mo>=</mo><msup><mrow><mo>(</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><msub><mi>η</mi><mn>1</mn></msub><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>−</mo><msub><mi>η</mi><mn>2</mn></msub><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>1</mn></msub></mrow><mrow><msub><mi>η</mi><mn>1</mn></msub><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub><mo>+</mo><msub><mi>η</mi><mn>2</mn></msub><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>1</mn></msub></mrow></mfrac></mstyle><mo>)</mo></mrow><mn>2</mn></msup><mo>.</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-63">
\begin{array}{l}
F_{R\parallel} = \left( \dfrac{\eta_2 \cos\theta_1 - \eta_1 \cos \theta_2}{\eta_2 \cos\theta_1 + \eta_1 \cos \theta_2} \right)^2,\\
F_{R\perp} = \left( \dfrac{\eta_1 \cos\theta_2 - \eta_2 \cos \theta_1}{\eta_1 \cos\theta_2 + \eta_2 \cos \theta_1} \right)^2.
\end{array}
</script>

<p>By taking the average of the two we get the actual ratio of reflected light:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2225;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;&amp;#x22A5;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1005" style="width: 9.406em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 8.449em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.016em 1008.39em 3.381em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-1006"><span class="msubsup" id="MathJax-Span-1007"><span style="display: inline-block; position: relative; width: 1.129em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.62em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1008" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="mi" id="MathJax-Span-1009" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-1010" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mstyle" id="MathJax-Span-1011" style="padding-left: 0.341em;"><span class="mrow" id="MathJax-Span-1012"><span class="mfrac" id="MathJax-Span-1013"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; margin-right: 0.115em; margin-left: 0.115em;"><span style="position: absolute; clip: rect(3.156em 1000.4em 4.169em -999.997em); top: -4.671em; left: 50%; margin-left: -0.222em;"><span class="mn" id="MathJax-Span-1014" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(3.156em 1000.45em 4.169em -999.997em); top: -3.319em; left: 50%; margin-left: -0.222em;"><span class="mn" id="MathJax-Span-1015" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; clip: rect(0.847em 1000.62em 1.242em -999.997em); top: -1.292em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.622em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1016" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-1017"><span style="display: inline-block; position: relative; width: 1.467em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.62em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1018" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="texatom" id="MathJax-Span-1019"><span class="mrow" id="MathJax-Span-1020"><span class="mi" id="MathJax-Span-1021" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">R</span><span class="mo" id="MathJax-Span-1022" style="font-size: 70.7%; font-family: STIXGeneral;">∥</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-1023" style="font-family: STIXGeneral; padding-left: 0.228em;">+</span><span class="msubsup" id="MathJax-Span-1024" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 1.579em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.62em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1025" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="texatom" id="MathJax-Span-1026"><span class="mrow" id="MathJax-Span-1027"><span class="mi" id="MathJax-Span-1028" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">R</span><span class="mo" id="MathJax-Span-1029" style="font-size: 70.7%; font-family: STIXGeneral;">⊥</span></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-1030" style="font-family: STIXGeneral;">)</span><span class="mo" id="MathJax-Span-1031" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 2.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>F</mi><mi>R</mi></msub><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo stretchy="false">(</mo><msub><mi>F</mi><mrow class="MJX-TeXAtom-ORD"><mi>R</mi><mo stretchy="false">∥</mo></mrow></msub><mo>+</mo><msub><mi>F</mi><mrow class="MJX-TeXAtom-ORD"><mi>R</mi><mo>⊥</mo></mrow></msub><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-64">F_R = \dfrac{1}{2}(F_{R\parallel} + F_{R\perp}).</script>

<p>The terms <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1032" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.397em 1000.9em 1.41em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-1033"><span class="msubsup" id="MathJax-Span-1034"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1035" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-1036" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>η</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-65">\eta_1</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1037" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.397em 1000.9em 1.41em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-1038"><span class="msubsup" id="MathJax-Span-1039"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.381em 1000.45em 4.395em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1040" style="font-family: STIXGeneral; font-style: italic;">η</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.453em;"><span class="mn" id="MathJax-Span-1041" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>η</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-66">\eta_2</script> are the refraction indices of the two mediums. The terms <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1042" style="width: 2.706em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.424em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.42em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-1043"><span class="mi" id="MathJax-Span-1044" style="font-family: STIXGeneral;">cos</span><span class="mo" id="MathJax-Span-1045"></span><span class="msubsup" id="MathJax-Span-1046" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1047" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-1048" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-67">\cos\theta_1</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1049" style="width: 2.706em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.424em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.42em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-1050"><span class="mi" id="MathJax-Span-1051" style="font-family: STIXGeneral;">cos</span><span class="mo" id="MathJax-Span-1052"></span><span class="msubsup" id="MathJax-Span-1053" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1054" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-1055" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-68">\cos\theta_2</script> are the angle of incidence and refraction respectively. As mentioned before, due to conservation of energy, the ratio of refracted light can simply be computed as:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: left;"><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: left; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1056" style="width: 6.14em; display: inline-block; margin-left: 1.128em;"><span style="display: inline-block; position: relative; width: 5.521em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1005.47em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-1057"><span class="msubsup" id="MathJax-Span-1058"><span style="display: inline-block; position: relative; width: 1.129em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.62em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1059" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="mi" id="MathJax-Span-1060" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-1061" style="font-family: STIXGeneral; padding-left: 0.341em;">=</span><span class="mn" id="MathJax-Span-1062" style="font-family: STIXGeneral; padding-left: 0.341em;">1</span><span class="mo" id="MathJax-Span-1063" style="font-family: STIXGeneral; padding-left: 0.228em;">−</span><span class="msubsup" id="MathJax-Span-1064" style="padding-left: 0.228em;"><span style="display: inline-block; position: relative; width: 1.129em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.62em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1065" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="mi" id="MathJax-Span-1066" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span><span class="mo" id="MathJax-Span-1067" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>F</mi><mi>T</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>F</mi><mi>R</mi></msub><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-69">F_T = 1 - F_R.</script>

<p>Keep in mind that if light goes from a medium to another medium with a lower refraction index, it may be subject to the phenomenon of total internal reflection. This is obviously happening in the case of material such as glass or water, so we need to take this into account. We do so by computing as in the case of reflection, the sine of the angle of refraction or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1068" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.172em 1000.9em 1.354em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-1069"><span class="msubsup" id="MathJax-Span-1070"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1071" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-1072" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>θ</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-70">\theta_2</script>. If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1073" style="width: 2.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.255em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.25em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-1074"><span class="mi" id="MathJax-Span-1075" style="font-family: STIXGeneral;">sin</span><span class="mo" id="MathJax-Span-1076"></span><span class="msubsup" id="MathJax-Span-1077" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1078" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-1079" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>sin</mi><mo>⁡</mo><msub><mi>θ</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-71">\sin\theta_2</script> is greater than 1, then we have a case of total reflection. In this particular case, there is no need to compute the Fresnels formulas. We can just set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1080" style="width: 1.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.129em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.172em 1001.13em 1.354em -999.997em); top: -1.011em; left: 0em;"><span class="mrow" id="MathJax-Span-1081"><span class="msubsup" id="MathJax-Span-1082"><span style="display: inline-block; position: relative; width: 1.129em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.62em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1083" style="font-family: STIXGeneral; font-style: italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.059em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.622em;"><span class="mi" id="MathJax-Span-1084" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.016em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>F</mi><mi>R</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-72">F_R</script> to 1. As usual, you will need to swap the refraction indices if you find out that the incident ray is inside the object with the greatest refraction index. This can be done again by testing the sign of the cosine of the angle between the surface normal and the incident ray direction (the sign of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1085" style="width: 2.706em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.424em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.692em 1002.42em 2.874em -999.997em); top: -2.531em; left: 0em;"><span class="mrow" id="MathJax-Span-1086"><span class="mi" id="MathJax-Span-1087" style="font-family: STIXGeneral;">cos</span><span class="mo" id="MathJax-Span-1088"></span><span class="msubsup" id="MathJax-Span-1089" style="padding-left: 0.172em;"><span style="display: inline-block; position: relative; width: 0.904em; height: 0px;"><span style="position: absolute; clip: rect(3.156em 1000.51em 4.169em -999.997em); top: -3.995em; left: 0em;"><span class="mi" id="MathJax-Span-1090" style="font-family: STIXGeneral; font-style: italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span><span style="position: absolute; top: -3.826em; left: 0.51em;"><span class="mn" id="MathJax-Span-1091" style="font-size: 70.7%; font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 4.001em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.537em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>cos</mi><mo>⁡</mo><msub><mi>θ</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-73">\cos\theta_1</script>). Here is a possible implementation of the Fresnel formula:</p>

<div name="code" class="code"><div style="margin: 0px 10px; display: inline-block; float: left; width: auto; text-align: center; color: rgb(100, 100, 100);">001<br>002<br>003<br>004<br>005<br>006<br>007<br>008<br>009<br>010<br>011<br>012<br>013<br>014<br>015<br>016<br>017<br>018<br>019<br>020<br>021<br></div><div style="border-left: 1px solid rgb(100, 100, 100); padding-left: 10px; display: inline-block; width: auto; color: rgb(50, 50, 50);">void fresnel(<b>const</b> Vec3f &amp;I, <b>const</b> Vec3f &amp;N, <b>const</b> <b>float</b> &amp;ior, <b>float</b> &amp;kr) <br>{ <br>    <b>float</b> cosi = clamp(-1, 1, dotProduct(I, N)); <br>    <b>float</b> etai = 1, etat = ior; <br>    <b>if</b> (cosi &gt; 0) { std::swap(etai, etat); } <br>    <span style="color: rgb(100, 100, 100);">// Compute sini using Snell's law</span><br>    <b>float</b> sint = etai / etat * sqrtf(std::max(0.f, 1 - cosi * cosi)); <br>    <span style="color: rgb(100, 100, 100);">// Total internal reflection</span><br>    <b>if</b> (sint &gt;= 1) { <br>        kr = 1; <br>    } <br>    else { <br>        <b>float</b> cost = sqrtf(std::max(0.f, 1 - sint * sint)); <br>        cosi = fabsf(cosi); <br>        <b>float</b> Rs = ((etat * cosi) - (etai * cost)) / ((etat * cosi) + (etai * cost)); <br>        <b>float</b> Rp = ((etai * cosi) - (etat * cost)) / ((etai * cosi) + (etat * cost)); <br>        kr = (Rs * Rs + Rp * Rp) / 2; <br>    } <br>    <span style="color: rgb(100, 100, 100);">// As a consequence of the conservation of energy, transmittance is given by:</span><br>    <span style="color: rgb(100, 100, 100);">// kt = 1 - kr;</span><br>} <br></div></div>

<p>If you plot this function here is what the curves look like:</p>

<img class="left" style="margin-bottom: 12px;" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-refraction11.png">

<p>The curve on the left shows the ratio of reflected light in the case of an air-glass transition. The curve on the right shows the same ratio for a transition glass-air. As you can see, 100% of the light is reflected when we reach an angle of incidence much smaller than 90 degrees in the second cube. This is due to the phenomenon of total internal reflection.</p>

<div style="width: 450;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-fresnel1.png"><p class="caption left">Figure 15:  the ratio of reflected light increases as the angle between the view direction and the surface normal increases.</p>
</div>

<div style="width: 450;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-fresnel3.png"><p class="caption left">Figure 16:  the ratio of reflected light increases as the angle between the view direction and the surface normal increases.</p>
</div>

<p>The fresnel effect can easily be observed in nature. If you look at the picture of the lake with some mountains in the background and pebbles in the foreground at the beginning of this chapter, you can see that the reflection seems to increase with distance. Note also that while reflections are strong in the distance, we see more clearly through the water in the foreground that we do in the far distance. This is due to fresnel. The angle of incidence increases with the distance as shown in figure 16, and we know that the ratio of reflection vs. transmission increases with the angle of incidence. Thus naturally as we look in the distance, the water surface reflects more light. Though if we look almost directly down on the water surface, a few meters from where we stand, the angle incidence is low and most of the light is actually transmitted. Thus we see through the water more clearly than when we look in the distance. You can easily observe this effect on a large variety of objects: the facade of building made out of glass, glass balls which are more reflective on the edges, etc.</p>

<h2>Implementation</h2>

<p>Let's now put everything we learned so far, and try to reproduce the image of the pen in a glass of water. For this exercise we will just model the volume of water with a simple cylinder. To keep things simple we haven't created a model of the glass containing the volume of water. This is left as an exercise. The scene is rendered with a distance light. To keep things simple, the water volume doesn't cast shadow. Shadow casting of transparent objects will be studied in a separate lesson. The pen is rendered using a flat shading model. The rest of the scene uses smooth shading (interpolation of vertex normals). First we declare the volume model as both a reflective and refractive surface. We also added an <span class="code-inline">ior</span> member variable to the object class to store the object index of refraction:</p>

<div name="code" class="code"><div style="margin: 0px 10px; display: inline-block; float: left; width: auto; text-align: center; color: rgb(100, 100, 100);">001<br>002<br>003<br>004<br>005<br>006<br></div><div style="border-left: 1px solid rgb(100, 100, 100); padding-left: 10px; display: inline-block; width: auto; color: rgb(50, 50, 50);">TriangleMesh *mesh3 = loadPolyMeshFromFile("./cylinder.geo", Matrix44f::kIdentity); <br><b>if</b> (mesh3 != nullptr) { <br>    mesh3-&gt;type = kReflectionAndRefraction; <br>    mesh3-&gt;ior = 1.3; <br>    objects.push_back(std::unique_ptr&lt;Object&gt;(mesh3)); <br>} <br></div></div>

<div style="width: 300;" class="captionImage right">
<img class="left" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-bias3.png"><p class="caption left">Figure 17:  because of numerical precision issues, the intersection point may actually be under the surface of the object the ray has hit. For this reason we need to push the reflection ray origin above the surface and the refracted ray origin below the surface by adding some artificial bias along the normal direction.</p>
</div>

<p>In the <span class="code-inline">castRay</span> function, we just added one case to the material switch. If the surface is both transparent, we then first compute the ratio of reflected light using the fresnel equation. Note that, as a small optimisation, we only compute the transmitted light if the ratio of reflected light is lower than 1 (this is not a case of total internal reflection). The reflected and refraction ray are then computed (lines 22 and 27) and the reflected and transmitted light is computed by tracing a ray in both the reflected and refracted direction. Note that we have to add a small bias again to the ray origin to avoid the phenomenon of acne which we already described in the chapters on shadows. In the case of reflection we need to push the point on the same side of the surface hit by the incident ray, and in the case of refraction, the points need to be pushed inward (figure 17).</p>

<p>The way we deal with acne in ray-tracing by pushing the ray origin in the normal direction is a very naive solution to this problem. Research to address this problem has been done and can be found on the web. An ideal solution is one in which the bias can be computed automatically as opposed to being fixed for the entire scene, or fixed on an object basis.</p>

<p>Finally the results are mixed using the result of the fresnel equation (line 32).</p>

<div name="code" class="code"><div style="margin: 0px 10px; display: inline-block; float: left; width: auto; text-align: center; color: rgb(100, 100, 100);">001<br>002<br>003<br>004<br>005<br>006<br>007<br>008<br>009<br>010<br>011<br>012<br>013<br>014<br>015<br>016<br>017<br>018<br>019<br>020<br>021<br>022<br>023<br>024<br>025<br>026<br>027<br>028<br>029<br>030<br>031<br>032<br>033<br>034<br>035<br>036<br>037<br></div><div style="border-left: 1px solid rgb(100, 100, 100); padding-left: 10px; display: inline-block; width: auto; color: rgb(50, 50, 50);">switch (isect.hitObject-&gt;type) { <br>    case kDiffuse: <br>    { <br>        ... <br>        break; <br>    } <br>    case kReflection: <br>    { <br>        ... <br>        break; <br>    } <br>    case kReflectionAndRefraction: <br>    { <br>        Vec3f refractionColor = 0; <br>        <span style="color: rgb(100, 100, 100);">// compute fresnel</span><br>        <b>float</b> kr; <br>        fresnel(dir, hitNormal, isect.hitObject-&gt;ior, kr); <br>        bool outside = dir.dotProduct(hitNormal) &lt; 0; <br>        Vec3f bias = options.bias * hitNormal; <br>        <span style="color: rgb(100, 100, 100);">// compute refraction if it is not a case of total internal reflection</span><br>        <b>if</b> (kr &lt; 1) { <br>            Vec3f refractionDirection = refract(dir, hitNormal, isect.hitObject-&gt;ior).normalize(); <br>            Vec3f refractionRayOrig = outside ? hitPoint - bias : hitPoint + bias; <br>            refractionColor = castRay(refractionRayOrig, refractionDirection, objects, lights, options, depth + 1); <br>        } <br> <br>        Vec3f reflectionDirection = reflect(dir, hitNormal).normalize(); <br>        Vec3f reflectionRayOrig = outside ? hitPoint + bias : hitPoint - bias; <br>        Vec3f reflectionColor = castRay(reflectionRayOrig, reflectionDirection, objects, lights, options, depth + 1); <br> <br>        <span style="color: rgb(100, 100, 100);">// mix the two</span><br>        hitColor += reflectionColor * kr + refractionColor * (1 - kr); <br>        break; <br>    } <br>    default: <br>        break; <br>} <br></div></div>

<img class="left" style="margin-bottom: 12px;" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-rendertest1.png">

<p>Note that the result we get is very similar to the same scene rendered with a commercial renderer (Mental Ray in this case). The difference between the two images come from the fact that in the reference image we set the max depth to 10 while in the image on right (our render), we set the max depth limit to 4. If you set the limit to 10, you will get the same image:</p>

<div name="code" class="code"><div style="margin: 0px 10px; display: inline-block; float: left; width: auto; text-align: center; color: rgb(100, 100, 100);">001<br></div><div style="border-left: 1px solid rgb(100, 100, 100); padding-left: 10px; display: inline-block; width: auto; color: rgb(50, 50, 50);">options.maxDepth = 10; <br></div></div>

<img class="right" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-rendertest2.png">

<p>Note that the effect of the refracted pen in the water is very similar to the image in figure 8. While subtle, the fresnel effect on the edges of the water volume is also visible. Some people don't feel that this image is actually photo-real. Through from a physical point of view, it is. If you do not simulate the internal reflections though, you get an image like the one of the right, which might seem visual more real. This is also what the art of shading is all about. To the contrary of nature, you have a control on many different aspects of the simulation and by changing various settings (whether you similar internal reflections or not, the maximum ray depth, etc.) you can control the look of the final rendered image.</p> 

<h2>Other Things You Should Know About Reflection: Conductor and Dielectric.</h2>

<p>This is already a long chapter in which we introduced many fondamental concepts from shading. Namely we talked about:</p>

<ul>
<li>Reflection,</li>
<li>Refraction,</li>
<li>Fresnel,</li>
<li>and ray scene and bias as a side effect of using ray-tracing to compute or simulate these effects.</li>
</ul>

<img class="right" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/shad-metal.jpg">

<p>There is many more things to say about these different effects. For example that reflections is a wavelength effect. Indeed material do not refract light of different wavelength the same way. We will study these details later. Though one thing you may want to know before we close this chapter, is that metallic objects too reflect light. In fact, in computer graphics we like to classify materials in two broad categories: the <b>dielectric</b> materials and the <b>conductor</b> materials. Conductors as you may have guessed are metals. Metals too reflect light and they also reflect more light at grazing angle. Though the fresnel equation used to reflect the ratio of reflected light by metals is different than the one we studied in this lesson which is used to simulate the fresnel effect of dielectric materials. Dielectric are essentially non conducting materials or electric insulators for example. In this category you find things such as glass or plastic as well as water. Pure water is an electric insulator indeed. Remember the names <b>conductor</b> and <b>dielectric</b> as they are used a lot in shading and computer graphics.</p></article></div><!-- end of page-content -->
			<div class="footer-prev-next">
			<div class="footer-column"><div class="footer-prev-next-row">
				<div class="footer-prev-next-cell" style="text-align: left;"><p><a href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/shading-multiple-lights"><i style="float: left;" class="material-icons">arrow_back</i>Previous Chapter</a></p></div>
				<div class="footer-prev-next-cell" style="text-align: center;"><p>Chapter 8 of  10</p></div>
				<div class="footer-prev-next-cell" style="text-align: right;"><p><a href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/procedural-texturing">Next Chapter <i style="float: right;" class="material-icons">arrow_forward</i></a></p></div>
			</div></div>
			</div>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./Introduction to Shading (Reflection, Refraction and Fresnel)_files/saved_resource.html"></iframe></body></html>